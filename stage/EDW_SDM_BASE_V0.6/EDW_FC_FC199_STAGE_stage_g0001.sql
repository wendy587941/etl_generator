-- SQL for table: EDW_FC_FC199_STAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Stage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Prestage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CURCD,
KIND,
SYMD,
EYMD,
"END",
AMTCURCD,
AMT,
HAMT,
MEMO,
HEAD,
RATEKIND,
OBUFG,
OPENBR,
"NEW",
"LIMIT",
"902ADD",
RATE_1,
ACRATE_1,
RATE_2,
ACRATE_2,
RATE_3,
ACRATE_3,
RATE_4,
ACRATE_4,
RATE_5,
ACRATE_5,
RATE_6,
ACRATE_6,
RATE_7,
ACRATE_7,
RATE_8,
ACRATE_8,
RATE_9,
ACRATE_9,
RATE_10,
ACRATE_10,
RATE_11,
ACRATE_11,
RATE_12,
ACRATE_12,
RATE_13,
ACRATE_13,
RATE_14,
ACRATE_14,
RATE_15,
ACRATE_15,
RATE_16,
ACRATE_16,
RATE_17,
ACRATE_17,
RATE_18,
ACRATE_18,
RATE_19,
ACRATE_19,
RATE_20,
ACRATE_20,
RATE_21,
ACRATE_21,
RATE_22,
ACRATE_22,
RATE_23,
ACRATE_23,
RATE_24,
ACRATE_24,
EMPNOT,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CURCD,
KIND,
SYMD,
EYMD,
"END",
AMTCURCD,
AMT,
HAMT,
MEMO,
HEAD,
RATEKIND,
OBUFG,
OPENBR,
"NEW",
"LIMIT",
"902ADD",
RATE_1,
ACRATE_1,
RATE_2,
ACRATE_2,
RATE_3,
ACRATE_3,
RATE_4,
ACRATE_4,
RATE_5,
ACRATE_5,
RATE_6,
ACRATE_6,
RATE_7,
ACRATE_7,
RATE_8,
ACRATE_8,
RATE_9,
ACRATE_9,
RATE_10,
ACRATE_10,
RATE_11,
ACRATE_11,
RATE_12,
ACRATE_12,
RATE_13,
ACRATE_13,
RATE_14,
ACRATE_14,
RATE_15,
ACRATE_15,
RATE_16,
ACRATE_16,
RATE_17,
ACRATE_17,
RATE_18,
ACRATE_18,
RATE_19,
ACRATE_19,
RATE_20,
ACRATE_20,
RATE_21,
ACRATE_21,
RATE_22,
ACRATE_22,
RATE_23,
ACRATE_23,
RATE_24,
ACRATE_24,
EMPNOT,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
