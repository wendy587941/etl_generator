-- SQL for table: EDW_FC_FCMR_STAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Stage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Prestage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
MBRNO,
MAPNO,
MSRNO,
MCHKDG,
MOBRNO,
MOAPNO,
MOSRNO,
MOCHKDG,
MIBRNO,
MIAPNO,
MISRNO,
MICHKDG,
MRERR,
NBCD,
ACTSTP,
HIDENCD,
ACTSLP,
REMAIND,
ACTMVO,
ACTMVI,
MRTGE,
MAILCD,
ADVCD,
ACTCLS,
CHOP,
UNINO,
CORPNO,
PIDNO,
BCODE,
TAXCD,
RBRNO,
CHARCD,
PASWD,
PBCNT,
CTCNT,
MTCNT,
ASCNT,
PBVER,
PBPAGE,
PBCOL,
CTPAGE,
CTCOL,
OPDAY,
MODAY,
MIDAY,
LTXDAY,
BOOKDAY,
NTDPBAL,
NTWHBAL,
CHGAMT,
CHOPAMT,
CSDAY,
CEDAY,
LCURCD_1,
LCURCD_2,
LCURCD_3,
LCURCD_4,
LCURCD_5,
LCURCD_6,
LCURCD_7,
LCURCD_8,
LCURCD_9,
LCURCD_10,
LCURCD_11,
LCURCD_12,
LCURCD_13,
LCURCD_14,
LCURCD_15,
LCURCD_16,
LCURCD_17,
LCURCD_18,
LCURCD_19,
LCURCD_20,
LCURCD_21,
LCURCD_22,
LCURCD_23,
LCURCD_24,
LCURCD_25,
LCURCD_26,
LCURCD_27,
LCURCD_28,
LCURCD_29,
LCURCD_30,
IXPR_1,
IXPR_2,
IXPR_3,
IXPR_4,
IXPR_5,
IXPR_6,
IXPR_7,
IXPR_8,
IXPR_9,
IXPR_10,
IXPR_11,
IXPR_12,
IXPR_13,
IXPR_14,
IXPR_15,
IXPR_16,
IXPR_17,
IXPR_18,
IXPR_19,
IXPR_20,
IXPR_21,
IXPR_22,
IXPR_23,
IXPR_24,
IXPR_25,
IXPR_26,
IXPR_27,
IXPR_28,
IXPR_29,
IXPR_30,
RCSDAY,
RCEDAY,
RLCURCD_1,
RLCURCD_2,
RLCURCD_3,
RLCURCD_4,
RLCURCD_5,
RLCURCD_6,
RLCURCD_7,
RLCURCD_8,
RLCURCD_9,
RLCURCD_10,
RLCURCD_11,
RLCURCD_12,
RLCURCD_13,
RLCURCD_14,
RLCURCD_15,
RLCURCD_16,
RLCURCD_17,
RLCURCD_18,
RLCURCD_19,
RLCURCD_20,
RLCURCD_21,
RLCURCD_22,
RLCURCD_23,
RLCURCD_24,
RLCURCD_25,
RLCURCD_26,
RLCURCD_27,
RLCURCD_28,
RLCURCD_29,
RLCURCD_30,
RIXPR_1,
RIXPR_2,
RIXPR_3,
RIXPR_4,
RIXPR_5,
RIXPR_6,
RIXPR_7,
RIXPR_8,
RIXPR_9,
RIXPR_10,
RIXPR_11,
RIXPR_12,
RIXPR_13,
RIXPR_14,
RIXPR_15,
RIXPR_16,
RIXPR_17,
RIXPR_18,
RIXPR_19,
RIXPR_20,
RIXPR_21,
RIXPR_22,
RIXPR_23,
RIXPR_24,
RIXPR_25,
RIXPR_26,
RIXPR_27,
RIXPR_28,
RIXPR_29,
RIXPR_30,
PNBERR,
PNBDAY,
PNBSEQ,
PNBCNT,
PNBNSEQ,
PLNBDAY,
PBBAL_1,
PBBAL_2,
PBBAL_3,
PBBAL_4,
PBBAL_5,
PBBAL_6,
PBBAL_7,
PBBAL_8,
PBBAL_9,
PBBAL_10,
PBBAL_11,
PBBAL_12,
PBBAL_13,
PBBAL_14,
PBBAL_15,
PBBAL_16,
PBBAL_17,
PBBAL_18,
PBBAL_19,
PBBAL_20,
PBBAL_21,
PBBAL_22,
PBBAL_23,
PBBAL_24,
PBBAL_25,
PBBAL_26,
PBBAL_27,
PBBAL_28,
PBBAL_29,
PBBAL_30,
PBMTBAL_1,
PBMTBAL_2,
PBMTBAL_3,
PBMTBAL_4,
PBMTBAL_5,
PBMTBAL_6,
PBMTBAL_7,
PBMTBAL_8,
PBMTBAL_9,
PBMTBAL_10,
PBMTBAL_11,
PBMTBAL_12,
PBMTBAL_13,
PBMTBAL_14,
PBMTBAL_15,
PBMTBAL_16,
PBMTBAL_17,
PBMTBAL_18,
PBMTBAL_19,
PBMTBAL_20,
PBMTBAL_21,
PBMTBAL_22,
PBMTBAL_23,
PBMTBAL_24,
PBMTBAL_25,
PBMTBAL_26,
PBMTBAL_27,
PBMTBAL_28,
PBMTBAL_29,
PBMTBAL_30,
CNBERR,
CNBDAY,
CNBSEQ,
CNBCNT,
CNBNSEQ,
CLNBDAY,
ERPASSW,
RGBNO,
EIDERR,
PIDERR,
IRTCD,
CURFG,
NOIBK,
CBRNO,
OBRNO,
ODAY,
SLPBRNO1,
SLPDAY1,
SLPBRNO2,
SLPDAY2,
PRTCD,
NCHOPAMT,
SBRNO,
SLPFLG,
AOUNINO,
AGE,
UKIND,
UMARK,
UACNO,
Q60ERR,
UIDNO,
Q60ERDAY,
BK30DAY,
LSTDAY,
OBULN,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
MBRNO,
MAPNO,
MSRNO,
MCHKDG,
MOBRNO,
MOAPNO,
MOSRNO,
MOCHKDG,
MIBRNO,
MIAPNO,
MISRNO,
MICHKDG,
MRERR,
NBCD,
ACTSTP,
HIDENCD,
ACTSLP,
REMAIND,
ACTMVO,
ACTMVI,
MRTGE,
MAILCD,
ADVCD,
ACTCLS,
CHOP,
UNINO,
CORPNO,
PIDNO,
BCODE,
TAXCD,
RBRNO,
CHARCD,
PASWD,
PBCNT,
CTCNT,
MTCNT,
ASCNT,
PBVER,
PBPAGE,
PBCOL,
CTPAGE,
CTCOL,
OPDAY,
MODAY,
MIDAY,
LTXDAY,
BOOKDAY,
NTDPBAL,
NTWHBAL,
CHGAMT,
CHOPAMT,
CSDAY,
CEDAY,
LCURCD_1,
LCURCD_2,
LCURCD_3,
LCURCD_4,
LCURCD_5,
LCURCD_6,
LCURCD_7,
LCURCD_8,
LCURCD_9,
LCURCD_10,
LCURCD_11,
LCURCD_12,
LCURCD_13,
LCURCD_14,
LCURCD_15,
LCURCD_16,
LCURCD_17,
LCURCD_18,
LCURCD_19,
LCURCD_20,
LCURCD_21,
LCURCD_22,
LCURCD_23,
LCURCD_24,
LCURCD_25,
LCURCD_26,
LCURCD_27,
LCURCD_28,
LCURCD_29,
LCURCD_30,
IXPR_1,
IXPR_2,
IXPR_3,
IXPR_4,
IXPR_5,
IXPR_6,
IXPR_7,
IXPR_8,
IXPR_9,
IXPR_10,
IXPR_11,
IXPR_12,
IXPR_13,
IXPR_14,
IXPR_15,
IXPR_16,
IXPR_17,
IXPR_18,
IXPR_19,
IXPR_20,
IXPR_21,
IXPR_22,
IXPR_23,
IXPR_24,
IXPR_25,
IXPR_26,
IXPR_27,
IXPR_28,
IXPR_29,
IXPR_30,
RCSDAY,
RCEDAY,
RLCURCD_1,
RLCURCD_2,
RLCURCD_3,
RLCURCD_4,
RLCURCD_5,
RLCURCD_6,
RLCURCD_7,
RLCURCD_8,
RLCURCD_9,
RLCURCD_10,
RLCURCD_11,
RLCURCD_12,
RLCURCD_13,
RLCURCD_14,
RLCURCD_15,
RLCURCD_16,
RLCURCD_17,
RLCURCD_18,
RLCURCD_19,
RLCURCD_20,
RLCURCD_21,
RLCURCD_22,
RLCURCD_23,
RLCURCD_24,
RLCURCD_25,
RLCURCD_26,
RLCURCD_27,
RLCURCD_28,
RLCURCD_29,
RLCURCD_30,
RIXPR_1,
RIXPR_2,
RIXPR_3,
RIXPR_4,
RIXPR_5,
RIXPR_6,
RIXPR_7,
RIXPR_8,
RIXPR_9,
RIXPR_10,
RIXPR_11,
RIXPR_12,
RIXPR_13,
RIXPR_14,
RIXPR_15,
RIXPR_16,
RIXPR_17,
RIXPR_18,
RIXPR_19,
RIXPR_20,
RIXPR_21,
RIXPR_22,
RIXPR_23,
RIXPR_24,
RIXPR_25,
RIXPR_26,
RIXPR_27,
RIXPR_28,
RIXPR_29,
RIXPR_30,
PNBERR,
PNBDAY,
PNBSEQ,
PNBCNT,
PNBNSEQ,
PLNBDAY,
PBBAL_1,
PBBAL_2,
PBBAL_3,
PBBAL_4,
PBBAL_5,
PBBAL_6,
PBBAL_7,
PBBAL_8,
PBBAL_9,
PBBAL_10,
PBBAL_11,
PBBAL_12,
PBBAL_13,
PBBAL_14,
PBBAL_15,
PBBAL_16,
PBBAL_17,
PBBAL_18,
PBBAL_19,
PBBAL_20,
PBBAL_21,
PBBAL_22,
PBBAL_23,
PBBAL_24,
PBBAL_25,
PBBAL_26,
PBBAL_27,
PBBAL_28,
PBBAL_29,
PBBAL_30,
PBMTBAL_1,
PBMTBAL_2,
PBMTBAL_3,
PBMTBAL_4,
PBMTBAL_5,
PBMTBAL_6,
PBMTBAL_7,
PBMTBAL_8,
PBMTBAL_9,
PBMTBAL_10,
PBMTBAL_11,
PBMTBAL_12,
PBMTBAL_13,
PBMTBAL_14,
PBMTBAL_15,
PBMTBAL_16,
PBMTBAL_17,
PBMTBAL_18,
PBMTBAL_19,
PBMTBAL_20,
PBMTBAL_21,
PBMTBAL_22,
PBMTBAL_23,
PBMTBAL_24,
PBMTBAL_25,
PBMTBAL_26,
PBMTBAL_27,
PBMTBAL_28,
PBMTBAL_29,
PBMTBAL_30,
CNBERR,
CNBDAY,
CNBSEQ,
CNBCNT,
CNBNSEQ,
CLNBDAY,
ERPASSW,
RGBNO,
EIDERR,
PIDERR,
IRTCD,
CURFG,
NOIBK,
CBRNO,
OBRNO,
ODAY,
SLPBRNO1,
SLPDAY1,
SLPBRNO2,
SLPDAY2,
PRTCD,
NCHOPAMT,
SBRNO,
SLPFLG,
AOUNINO,
AGE,
UKIND,
UMARK,
UACNO,
Q60ERR,
UIDNO,
Q60ERDAY,
BK30DAY,
LSTDAY,
OBULN,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
