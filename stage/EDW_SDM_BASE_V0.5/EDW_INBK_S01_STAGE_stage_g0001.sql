-- SQL for table: EDW_INBK_S01_STAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Stage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Prestage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
MSGKIND,
BKNO,
DD,
STAN,
MSGFLOW,
FILLER1,
UPDFLG,
PENDING,
TMOUT,
BUSDT,
ERRNO,
RMHC,
CDMODE,
FISCDT,
BRNO,
TXDT,
TXTM,
DBK,
DBR,
SBK,
SBR,
TXAMT,
RTNCD,
MT,
PC,
FIL1,
FIL2,
LOGNO,
ACTN1,
ACTN2,
ACTNO_N,
RC,
ER,
DATA,
CDWSNO,
EEBKID,
ERBKID,
EEACTNO,
ERACTNO,
CD_HC,
CD_CRDB,
CD_TYPE,
RCVID,
ISUID,
ISN,
RMSEQ,
COLNO,
TAPID,
OISN,
OPROCD,
RMSTATUS,
FILLER2,
CARDNO,
CHIP_ACTNO,
CHIP_ISUCNT,
FILLER3,
ACTKIND,
TXCUR,
WTHAMT,
LOCALTM,
SETLDT,
SETLAMT,
OKAMT,
SETLAMT2,
VMSGTP,
VSTAN,
VGMT,
VACQID,
SETLCUR,
SETLFEE,
TRANTYPE,
COUNTCODE,
FILLER4,
FILLER5,
TPDATE,
"TYPE",
CODE,
PIDNO,
TPNO,
FEE_1,
FEE_2,
FILLER6,
FILLER7,
PUR_ORDNO,
PUR_MID,
PUR_XFRSULT,
PUR_OTXTIME,
PUR_OSTAN,
FILLER8,
FILLER9,
D_CARDNO,
D_RRN,
D_PEM,
D_MCC,
D_PCC,
D_MID,
D_AMT,
FILLER10,
FILLER11,
FTXCUR,
FRATE,
NTHC,
JNHC,
FAMT,
FSEQ,
FILLER12,
OSTAN,
ODATE,
REAS,
FILLER13,
FMID,
FORDNO,
FILLER14,
EBSETLDT,
EBSETLAMT,
EBSETLCUR,
EBMID,
EBNTHC,
EBOBSDY,
EBOTXSEQ,
EBTWHC,
EBRRN,
FILLER15,
FILLER16,
TFR_DISC,
FILLER17,
TFR_PHONE,
FILLER18,
FILLER19,
COMMDATA,
TRMTYP,
COMMFIL,
RECNO,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
MSGKIND,
BKNO,
DD,
STAN,
MSGFLOW,
FILLER1,
UPDFLG,
PENDING,
TMOUT,
BUSDT,
ERRNO,
RMHC,
CDMODE,
FISCDT,
BRNO,
TXDT,
TXTM,
DBK,
DBR,
SBK,
SBR,
TXAMT,
RTNCD,
MT,
PC,
FIL1,
FIL2,
LOGNO,
ACTN1,
ACTN2,
ACTNO_N,
RC,
ER,
DATA,
CDWSNO,
EEBKID,
ERBKID,
EEACTNO,
ERACTNO,
CD_HC,
CD_CRDB,
CD_TYPE,
RCVID,
ISUID,
ISN,
RMSEQ,
COLNO,
TAPID,
OISN,
OPROCD,
RMSTATUS,
FILLER2,
CARDNO,
CHIP_ACTNO,
CHIP_ISUCNT,
FILLER3,
ACTKIND,
TXCUR,
WTHAMT,
LOCALTM,
SETLDT,
SETLAMT,
OKAMT,
SETLAMT2,
VMSGTP,
VSTAN,
VGMT,
VACQID,
SETLCUR,
SETLFEE,
TRANTYPE,
COUNTCODE,
FILLER4,
FILLER5,
TPDATE,
"TYPE",
CODE,
PIDNO,
TPNO,
FEE_1,
FEE_2,
FILLER6,
FILLER7,
PUR_ORDNO,
PUR_MID,
PUR_XFRSULT,
PUR_OTXTIME,
PUR_OSTAN,
FILLER8,
FILLER9,
D_CARDNO,
D_RRN,
D_PEM,
D_MCC,
D_PCC,
D_MID,
D_AMT,
FILLER10,
FILLER11,
FTXCUR,
FRATE,
NTHC,
JNHC,
FAMT,
FSEQ,
FILLER12,
OSTAN,
ODATE,
REAS,
FILLER13,
FMID,
FORDNO,
FILLER14,
EBSETLDT,
EBSETLAMT,
EBSETLCUR,
EBMID,
EBNTHC,
EBOBSDY,
EBOTXSEQ,
EBTWHC,
EBRRN,
FILLER15,
FILLER16,
TFR_DISC,
FILLER17,
TFR_PHONE,
FILLER18,
FILLER19,
COMMDATA,
TRMTYP,
COMMFIL,
RECNO,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
