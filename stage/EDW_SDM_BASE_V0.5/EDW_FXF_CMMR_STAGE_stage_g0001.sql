-- SQL for table: EDW_FXF_CMMR_STAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Stage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Prestage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CIFKEY,
BRNO,
YEAR,
CEXAMT(1),
CEXAMT(2),
CEXAMT(3),
CEXAMT(4),
CEXAMT(5),
CEXAMT(6),
CEXAMT(7),
CEXAMT(8),
CEXAMT(9),
CEXAMT(10),
CEXAMT(11),
CEXAMT(12),
CEXCNT(1),
CEXCNT(2),
CEXCNT(3),
CEXCNT(4),
CEXCNT(5),
CEXCNT(6),
CEXCNT(7),
CEXCNT(8),
CEXCNT(9),
CEXCNT(10),
CEXCNT(11),
CEXCNT(12),
NEXAMT(1),
NEXAMT(2),
NEXAMT(3),
NEXAMT(4),
NEXAMT(5),
NEXAMT(6),
NEXAMT(7),
NEXAMT(8),
NEXAMT(9),
NEXAMT(10),
NEXAMT(11),
NEXAMT(12),
NEXCNT(1),
NEXCNT(2),
NEXCNT(3),
NEXCNT(4),
NEXCNT(5),
NEXCNT(6),
NEXCNT(7),
NEXCNT(8),
NEXCNT(9),
NEXCNT(10),
NEXCNT(11),
NEXCNT(12),
CIMAMT(1),
CIMAMT(2),
CIMAMT(3),
CIMAMT(4),
CIMAMT(5),
CIMAMT(6),
CIMAMT(7),
CIMAMT(8),
CIMAMT(9),
CIMAMT(10),
CIMAMT(11),
CIMAMT(12),
CIMCNT(1),
CIMCNT(2),
CIMCNT(3),
CIMCNT(4),
CIMCNT(5),
CIMCNT(6),
CIMCNT(7),
CIMCNT(8),
CIMCNT(9),
CIMCNT(10),
CIMCNT(11),
CIMCNT(12),
NIMAMT(1),
NIMAMT(2),
NIMAMT(3),
NIMAMT(4),
NIMAMT(5),
NIMAMT(6),
NIMAMT(7),
NIMAMT(8),
NIMAMT(9),
NIMAMT(10),
NIMAMT(11),
NIMAMT(12),
NIMCNT(1),
NIMCNT(2),
NIMCNT(3),
NIMCNT(4),
NIMCNT(5),
NIMCNT(6),
NIMCNT(7),
NIMCNT(8),
NIMCNT(9),
NIMCNT(10),
NIMCNT(11),
NIMCNT(12),
CIRAMT(1),
CIRAMT(2),
CIRAMT(3),
CIRAMT(4),
CIRAMT(5),
CIRAMT(6),
CIRAMT(7),
CIRAMT(8),
CIRAMT(9),
CIRAMT(10),
CIRAMT(11),
CIRAMT(12),
CIRCNT(1),
CIRCNT(2),
CIRCNT(3),
CIRCNT(4),
CIRCNT(5),
CIRCNT(6),
CIRCNT(7),
CIRCNT(8),
CIRCNT(9),
CIRCNT(10),
CIRCNT(11),
CIRCNT(12),
NIRAMT(1),
NIRAMT(2),
NIRAMT(3),
NIRAMT(4),
NIRAMT(5),
NIRAMT(6),
NIRAMT(7),
NIRAMT(8),
NIRAMT(9),
NIRAMT(10),
NIRAMT(11),
NIRAMT(12),
NIRCNT(1),
NIRCNT(2),
NIRCNT(3),
NIRCNT(4),
NIRCNT(5),
NIRCNT(6),
NIRCNT(7),
NIRCNT(8),
NIRCNT(9),
NIRCNT(10),
NIRCNT(11),
NIRCNT(12),
CORAMT(1),
CORAMT(2),
CORAMT(3),
CORAMT(4),
CORAMT(5),
CORAMT(6),
CORAMT(7),
CORAMT(8),
CORAMT(9),
CORAMT(10),
CORAMT(11),
CORAMT(12),
CORCNT(1),
CORCNT(2),
CORCNT(3),
CORCNT(4),
CORCNT(5),
CORCNT(6),
CORCNT(7),
CORCNT(8),
CORCNT(9),
CORCNT(10),
CORCNT(11),
CORCNT(12),
NORAMT(1),
NORAMT(2),
NORAMT(3),
NORAMT(4),
NORAMT(5),
NORAMT(6),
NORAMT(7),
NORAMT(8),
NORAMT(9),
NORAMT(10),
NORAMT(11),
NORAMT(12),
NORCNT(1),
NORCNT(2),
NORCNT(3),
NORCNT(4),
NORCNT(5),
NORCNT(6),
NORCNT(7),
NORCNT(8),
NORCNT(9),
NORCNT(10),
NORCNT(11),
NORCNT(12),
BEXAMT(1),
BEXAMT(2),
BEXAMT(3),
BEXAMT(4),
BEXAMT(5),
BEXAMT(6),
BEXAMT(7),
BEXAMT(8),
BEXAMT(9),
BEXAMT(10),
BEXAMT(11),
BEXAMT(12),
BEXCNT(1),
BEXCNT(2),
BEXCNT(3),
BEXCNT(4),
BEXCNT(5),
BEXCNT(6),
BEXCNT(7),
BEXCNT(8),
BEXCNT(9),
BEXCNT(10),
BEXCNT(11),
BEXCNT(12),
BOTAMT(1),
BOTAMT(2),
BOTAMT(3),
BOTAMT(4),
BOTAMT(5),
BOTAMT(6),
BOTAMT(7),
BOTAMT(8),
BOTAMT(9),
BOTAMT(10),
BOTAMT(11),
BOTAMT(12),
BOTCNT(1),
BOTCNT(2),
BOTCNT(3),
BOTCNT(4),
BOTCNT(5),
BOTCNT(6),
BOTCNT(7),
BOTCNT(8),
BOTCNT(9),
BOTCNT(10),
BOTCNT(11),
BOTCNT(12),
SEXAMT(1),
SEXAMT(2),
SEXAMT(3),
SEXAMT(4),
SEXAMT(5),
SEXAMT(6),
SEXAMT(7),
SEXAMT(8),
SEXAMT(9),
SEXAMT(10),
SEXAMT(11),
SEXAMT(12),
SEXCNT(1),
SEXCNT(2),
SEXCNT(3),
SEXCNT(4),
SEXCNT(5),
SEXCNT(6),
SEXCNT(7),
SEXCNT(8),
SEXCNT(9),
SEXCNT(10),
SEXCNT(11),
SEXCNT(12),
SOTAMT(1),
SOTAMT(2),
SOTAMT(3),
SOTAMT(4),
SOTAMT(5),
SOTAMT(6),
SOTAMT(7),
SOTAMT(8),
SOTAMT(9),
SOTAMT(10),
SOTAMT(11),
SOTAMT(12),
SOTCNT(1),
SOTCNT(2),
SOTCNT(3),
SOTCNT(4),
SOTCNT(5),
SOTCNT(6),
SOTCNT(7),
SOTCNT(8),
SOTCNT(9),
SOTCNT(10),
SOTCNT(11),
SOTCNT(12),
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CIFKEY,
BRNO,
YEAR,
CEXAMT(1),
CEXAMT(2),
CEXAMT(3),
CEXAMT(4),
CEXAMT(5),
CEXAMT(6),
CEXAMT(7),
CEXAMT(8),
CEXAMT(9),
CEXAMT(10),
CEXAMT(11),
CEXAMT(12),
CEXCNT(1),
CEXCNT(2),
CEXCNT(3),
CEXCNT(4),
CEXCNT(5),
CEXCNT(6),
CEXCNT(7),
CEXCNT(8),
CEXCNT(9),
CEXCNT(10),
CEXCNT(11),
CEXCNT(12),
NEXAMT(1),
NEXAMT(2),
NEXAMT(3),
NEXAMT(4),
NEXAMT(5),
NEXAMT(6),
NEXAMT(7),
NEXAMT(8),
NEXAMT(9),
NEXAMT(10),
NEXAMT(11),
NEXAMT(12),
NEXCNT(1),
NEXCNT(2),
NEXCNT(3),
NEXCNT(4),
NEXCNT(5),
NEXCNT(6),
NEXCNT(7),
NEXCNT(8),
NEXCNT(9),
NEXCNT(10),
NEXCNT(11),
NEXCNT(12),
CIMAMT(1),
CIMAMT(2),
CIMAMT(3),
CIMAMT(4),
CIMAMT(5),
CIMAMT(6),
CIMAMT(7),
CIMAMT(8),
CIMAMT(9),
CIMAMT(10),
CIMAMT(11),
CIMAMT(12),
CIMCNT(1),
CIMCNT(2),
CIMCNT(3),
CIMCNT(4),
CIMCNT(5),
CIMCNT(6),
CIMCNT(7),
CIMCNT(8),
CIMCNT(9),
CIMCNT(10),
CIMCNT(11),
CIMCNT(12),
NIMAMT(1),
NIMAMT(2),
NIMAMT(3),
NIMAMT(4),
NIMAMT(5),
NIMAMT(6),
NIMAMT(7),
NIMAMT(8),
NIMAMT(9),
NIMAMT(10),
NIMAMT(11),
NIMAMT(12),
NIMCNT(1),
NIMCNT(2),
NIMCNT(3),
NIMCNT(4),
NIMCNT(5),
NIMCNT(6),
NIMCNT(7),
NIMCNT(8),
NIMCNT(9),
NIMCNT(10),
NIMCNT(11),
NIMCNT(12),
CIRAMT(1),
CIRAMT(2),
CIRAMT(3),
CIRAMT(4),
CIRAMT(5),
CIRAMT(6),
CIRAMT(7),
CIRAMT(8),
CIRAMT(9),
CIRAMT(10),
CIRAMT(11),
CIRAMT(12),
CIRCNT(1),
CIRCNT(2),
CIRCNT(3),
CIRCNT(4),
CIRCNT(5),
CIRCNT(6),
CIRCNT(7),
CIRCNT(8),
CIRCNT(9),
CIRCNT(10),
CIRCNT(11),
CIRCNT(12),
NIRAMT(1),
NIRAMT(2),
NIRAMT(3),
NIRAMT(4),
NIRAMT(5),
NIRAMT(6),
NIRAMT(7),
NIRAMT(8),
NIRAMT(9),
NIRAMT(10),
NIRAMT(11),
NIRAMT(12),
NIRCNT(1),
NIRCNT(2),
NIRCNT(3),
NIRCNT(4),
NIRCNT(5),
NIRCNT(6),
NIRCNT(7),
NIRCNT(8),
NIRCNT(9),
NIRCNT(10),
NIRCNT(11),
NIRCNT(12),
CORAMT(1),
CORAMT(2),
CORAMT(3),
CORAMT(4),
CORAMT(5),
CORAMT(6),
CORAMT(7),
CORAMT(8),
CORAMT(9),
CORAMT(10),
CORAMT(11),
CORAMT(12),
CORCNT(1),
CORCNT(2),
CORCNT(3),
CORCNT(4),
CORCNT(5),
CORCNT(6),
CORCNT(7),
CORCNT(8),
CORCNT(9),
CORCNT(10),
CORCNT(11),
CORCNT(12),
NORAMT(1),
NORAMT(2),
NORAMT(3),
NORAMT(4),
NORAMT(5),
NORAMT(6),
NORAMT(7),
NORAMT(8),
NORAMT(9),
NORAMT(10),
NORAMT(11),
NORAMT(12),
NORCNT(1),
NORCNT(2),
NORCNT(3),
NORCNT(4),
NORCNT(5),
NORCNT(6),
NORCNT(7),
NORCNT(8),
NORCNT(9),
NORCNT(10),
NORCNT(11),
NORCNT(12),
BEXAMT(1),
BEXAMT(2),
BEXAMT(3),
BEXAMT(4),
BEXAMT(5),
BEXAMT(6),
BEXAMT(7),
BEXAMT(8),
BEXAMT(9),
BEXAMT(10),
BEXAMT(11),
BEXAMT(12),
BEXCNT(1),
BEXCNT(2),
BEXCNT(3),
BEXCNT(4),
BEXCNT(5),
BEXCNT(6),
BEXCNT(7),
BEXCNT(8),
BEXCNT(9),
BEXCNT(10),
BEXCNT(11),
BEXCNT(12),
BOTAMT(1),
BOTAMT(2),
BOTAMT(3),
BOTAMT(4),
BOTAMT(5),
BOTAMT(6),
BOTAMT(7),
BOTAMT(8),
BOTAMT(9),
BOTAMT(10),
BOTAMT(11),
BOTAMT(12),
BOTCNT(1),
BOTCNT(2),
BOTCNT(3),
BOTCNT(4),
BOTCNT(5),
BOTCNT(6),
BOTCNT(7),
BOTCNT(8),
BOTCNT(9),
BOTCNT(10),
BOTCNT(11),
BOTCNT(12),
SEXAMT(1),
SEXAMT(2),
SEXAMT(3),
SEXAMT(4),
SEXAMT(5),
SEXAMT(6),
SEXAMT(7),
SEXAMT(8),
SEXAMT(9),
SEXAMT(10),
SEXAMT(11),
SEXAMT(12),
SEXCNT(1),
SEXCNT(2),
SEXCNT(3),
SEXCNT(4),
SEXCNT(5),
SEXCNT(6),
SEXCNT(7),
SEXCNT(8),
SEXCNT(9),
SEXCNT(10),
SEXCNT(11),
SEXCNT(12),
SOTAMT(1),
SOTAMT(2),
SOTAMT(3),
SOTAMT(4),
SOTAMT(5),
SOTAMT(6),
SOTAMT(7),
SOTAMT(8),
SOTAMT(9),
SOTAMT(10),
SOTAMT(11),
SOTAMT(12),
SOTCNT(1),
SOTCNT(2),
SOTCNT(3),
SOTCNT(4),
SOTCNT(5),
SOTCNT(6),
SOTCNT(7),
SOTCNT(8),
SOTCNT(9),
SOTCNT(10),
SOTCNT(11),
SOTCNT(12),
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
