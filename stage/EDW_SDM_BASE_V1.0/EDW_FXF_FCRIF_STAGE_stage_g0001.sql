-- SQL for table: EDW_FXF_FCRIF_STAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Stage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Prestage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
BKCODE,
BRNO,
CHKDG,
SWFCD,
BKNAM1,
BKNAM2,
BRNAM,
BKADRFG_1,
BKADR1_1,
BKADR2_1,
BKADR3_1,
BKADR4_1,
BKADR5_1,
BKADR6_1,
BKADR7_1,
BKADR8_1,
BKADRFG_2,
BKADR1_2,
BKADR2_2,
BKADR3_2,
BKADR4_2,
BKADR5_2,
BKADR6_2,
BKADR7_2,
BKADR8_2,
BKADRFG_3,
BKADR1_3,
BKADR2_3,
BKADR3_3,
BKADR4_3,
BKADR5_3,
BKADR6_3,
BKADR7_3,
BKADR8_3,
CITY,
CNTRYCD,
NAL,
TLXNO,
FAXNO,
CTLDOC,
SWFCTL,
OURACT1,
OURACT2,
YYMM,
CLRCD1,
CLRTXT1,
CLRCD2,
CLRTXT2,
REMARK1,
REMARK2,
REMARK3,
REMARK4,
REMARK5,
REMARK6,
REMARK7,
REMARK8,
OVRAMT,
DELCD,
LASTDT,
CREDAT,
CLBKNO,
KINBR,
TLRNO,
SPFG,
SPRMK1,
SPRMK2,
BLACK_1,
BLACK_2,
BLACK_3,
BLACK_4,
BLACK_5,
BKNOTE,
RISK,
ORGRISK,
CDDNOTE,
KYCDT,
KYCLDT,
CDDDT,
PNAME1,
PNAME2,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
BKCODE,
BRNO,
CHKDG,
SWFCD,
BKNAM1,
BKNAM2,
BRNAM,
BKADRFG_1,
BKADR1_1,
BKADR2_1,
BKADR3_1,
BKADR4_1,
BKADR5_1,
BKADR6_1,
BKADR7_1,
BKADR8_1,
BKADRFG_2,
BKADR1_2,
BKADR2_2,
BKADR3_2,
BKADR4_2,
BKADR5_2,
BKADR6_2,
BKADR7_2,
BKADR8_2,
BKADRFG_3,
BKADR1_3,
BKADR2_3,
BKADR3_3,
BKADR4_3,
BKADR5_3,
BKADR6_3,
BKADR7_3,
BKADR8_3,
CITY,
CNTRYCD,
NAL,
TLXNO,
FAXNO,
CTLDOC,
SWFCTL,
OURACT1,
OURACT2,
YYMM,
CLRCD1,
CLRTXT1,
CLRCD2,
CLRTXT2,
REMARK1,
REMARK2,
REMARK3,
REMARK4,
REMARK5,
REMARK6,
REMARK7,
REMARK8,
OVRAMT,
DELCD,
LASTDT,
CREDAT,
CLBKNO,
KINBR,
TLRNO,
SPFG,
SPRMK1,
SPRMK2,
BLACK_1,
BLACK_2,
BLACK_3,
BLACK_4,
BLACK_5,
BKNOTE,
RISK,
ORGRISK,
CDDNOTE,
KYCDT,
KYCLDT,
CDDDT,
PNAME1,
PNAME2,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
