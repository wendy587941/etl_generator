-- SQL for table: EDW_FXF_OBUCIF_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CIFKEY,
CORPNO,
CNAME,
CCADDR,
OBUPASSNO,
CONAME,
JOB,
COAREA,
COTELNO,
COEXTNO,
EXPDAT,
REGNO,
MAINZIP,
MAINADR,
MAINADR2,
MAINADR3,
MAINADR4,
MAINADR5,
DBUID,
REVERIFY,
PASNOEXP,
CELLPHNO,
REGAGENT,
MNATION,
BILLZIP,
BILLADR1,
BILLADR2,
BILLADR3,
BILLADR4,
BILLADR5,
MULTIAC,
REVENUE,
CAPITALAMT,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
若為8碼則使用ME2.統一編號, 若為10碼則使用ME3.身分證號,
CORPNO,
ME1.姓名/名稱,
ME6.地址,
ME4.護照號碼,
ME1.姓名/名稱,
ME11.職稱,
COAREA,
ME7.電話,
COEXTNO,
EXPDAT,
REGNO,
MAINZIP,
ME6.地址,
ME6.地址,
ME6.地址,
ME6.地址,
ME6.地址,
ME2.統一編號,
REVERIFY,
PASNOEXP,
ME7.電話,
ME1.姓名/名稱,
MNATION,
BILLZIP,
ME6.地址,
ME6.地址,
ME6.地址,
ME6.地址,
ME6.地址,
MULTIAC,
REVENUE,
CAPITALAMT,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
