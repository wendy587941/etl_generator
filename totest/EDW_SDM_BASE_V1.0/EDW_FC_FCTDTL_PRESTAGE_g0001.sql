-- SQL for table: EDW_FC_FCTDTL_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
BRNO,
APNO,
SRNO,
CHKDG,
MBRNO,
MAPNO,
MSRNO,
MCHKDG,
MRERR,
ACTCLS,
ACTMVO,
ACTMVI,
CHGDP,
CTRVS,
CTRI,
ACTSTP,
CRTHLD,
BRHLD,
MRTGE,
ATERM,
PTERM,
MCLSCD,
INTRF,
GPACD,
REMAIND,
EXPCD,
ADVCD,
AUTIN,
PAYCD,
CURCD,
CHARCD,
IRTCD,
IRTID,
OPINTRT,
EXPER,
NEXPER,
LARGE,
CTNO,
TRNACT,
ELDCNT,
DWCNT,
PRDCD,
PRDCDD,
MATERM,
CIDAY,
ISDAY,
EDAY,
MODAY,
IRDAY,
IVDAY,
MCLSDAY,
AMCLSDAY,
ICIDAY,
PRIBAL,
CTBAL,
UDIAMT,
UDTAMT,
DIAMT,
DTAMT,
DPRAAMT,
CIAMT,
TUDIAMT,
TUDTAMT,
TDIAMT,
TDTAMT,
TCIAMT,
TUIAMT,
LBRNO,
LAPNO,
LSRNO,
LCHKDG,
NBRNO,
NAPNO,
NSRNO,
NCHKDG,
CRFLYM,
CRFLINT,
TCRLINT,
LINTRT,
CRFNYM,
CRFNINT,
TCRNINT,
NINTRT,
RXCNT,
XAPNO,
XCHARCD,
RXPCNT,
AXCNT,
LAPCNT,
LCHARCD,
LPCNT,
ASCNT,
ACHCNT,
AMGCNT,
ABHCNT,
STPBAL,
OVINTFG,
XTRNO,
BTPBAL,
BCIAMT,
BDWCNT,
HCODE,
TXDAY,
BTUDIA,
BTUDTA,
CRFINT,
CRFAMT,
BDIAMT,
BDTAMT,
BCRFLYM,
BCRLINT,
BLINTRT,
BCRFNYM,
BCRNINT,
BNINTRT,
DSCPT1,
DSCPT2,
DSCPT3,
PRTCD,
RBRNO,
OBRNO,
ODAY,
NTXDAY,
OPENBRNO,
EXPEREDAY,
PRDFG,
SBRNO,
IRTNO,
AOUNINO,
NIRTNO,
CASH,
UIDNO,
"199KIND",
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
BRNO,
APNO,
SDG.UFN_MASK_ACCT_SN(SRNO),
CHKDG,
MBRNO,
MAPNO,
SDG.UFN_MASK_ACCT_SN(MSRNO),
MCHKDG,
MRERR,
ACTCLS,
ACTMVO,
ACTMVI,
CHGDP,
CTRVS,
CTRI,
ACTSTP,
CRTHLD,
BRHLD,
MRTGE,
ATERM,
PTERM,
MCLSCD,
INTRF,
GPACD,
REMAIND,
EXPCD,
ADVCD,
AUTIN,
PAYCD,
CURCD,
CHARCD,
IRTCD,
IRTID,
OPINTRT,
EXPER,
NEXPER,
LARGE,
CTNO,
TRNACT,
ELDCNT,
DWCNT,
PRDCD,
PRDCDD,
MATERM,
CIDAY,
ISDAY,
EDAY,
MODAY,
IRDAY,
IVDAY,
MCLSDAY,
AMCLSDAY,
ICIDAY,
PRIBAL,
CTBAL,
UDIAMT,
UDTAMT,
DIAMT,
DTAMT,
DPRAAMT,
CIAMT,
TUDIAMT,
TUDTAMT,
TDIAMT,
TDTAMT,
TCIAMT,
TUIAMT,
LBRNO,
LAPNO,
SDG.UFN_MASK_ACCT_SN(LSRNO),
LCHKDG,
NBRNO,
NAPNO,
SDG.UFN_MASK_ACCT_SN(NSRNO),
NCHKDG,
CRFLYM,
CRFLINT,
TCRLINT,
LINTRT,
CRFNYM,
CRFNINT,
TCRNINT,
NINTRT,
RXCNT,
XAPNO,
XCHARCD,
RXPCNT,
AXCNT,
LAPCNT,
LCHARCD,
LPCNT,
ASCNT,
ACHCNT,
AMGCNT,
ABHCNT,
STPBAL,
OVINTFG,
XTRNO,
BTPBAL,
BCIAMT,
BDWCNT,
HCODE,
TXDAY,
BTUDIA,
BTUDTA,
CRFINT,
CRFAMT,
BDIAMT,
BDTAMT,
BCRFLYM,
BCRLINT,
BLINTRT,
BCRFNYM,
BCRNINT,
BNINTRT,
DSCPT1,
DSCPT2,
DSCPT3,
PRTCD,
RBRNO,
OBRNO,
ODAY,
NTXDAY,
OPENBRNO,
EXPEREDAY,
PRDFG,
SBRNO,
IRTNO,
AOUNINO,
NIRTNO,
CASH,
UIDNO,
"199KIND",
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
