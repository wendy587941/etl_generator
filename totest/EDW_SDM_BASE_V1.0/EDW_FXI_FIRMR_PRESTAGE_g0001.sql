-- SQL for table: EDW_FXI_FIRMR_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
APTYPE,
BRNO,
SRNO,
OBUFG,
RBRNO,
ACBRNO,
KINBR,
BKCUR,
BKSRNO,
CIFKEY,
CORPNO,
CURCD,
REMAMT,
REMDAT,
CLRCUR,
CLRSRNO,
USECD,
CHARCD,
RSWFCD,
ENTDAT,
THEIR,
ACTCLS,
HOLD,
NTCD,
IRCBFG,
HOLDAT,
NTAMT,
REMTYP,
REMBK,
REMSWFCD,
REMBKNM1,
REMBKNM2,
REMBKNM3,
VLDATE,
CLSDAT,
RECNAM1,
RECNAM2,
RECADR1,
RECADR2,
TELNO,
OPBRNO,
OPDAT,
FCEXP,
OSN,
RECSWFCD,
REMNAM1,
REMNAM2,
REMTELNO,
XRATE,
TXTNO,
WSNO,
LASTDT,
TLRNO,
TXCD,
MT110,
SRNBK,
RCVBRH,
CHKNO,
CUSTOM,
CN,
EXAMT,
RECINFO,
NTXDAY,
CNGOODS,
CNTRYCD,
REMINF1,
REMINF2,
REMINF3,
REMINF4,
REMADR1,
REMADR2,
REMADR3,
REMARK1,
REMARK2,
REMARK3,
REMARK4,
"690CODE",
NUSECDX,
UETR,
"33BCURNA",
"33B",
"71A",
"71FCUR",
"71FCUR2",
"71FCUR3",
"71FAMT",
"71FAMT2",
"71FAMT3",
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
APTYPE,
BRNO,
SRNO,
OBUFG,
RBRNO,
ACBRNO,
KINBR,
BKCUR,
BKSRNO,
SDG.UFN_MASK_BAN(CIFKEY),
CORPNO,
CURCD,
REMAMT,
REMDAT,
CLRCUR,
CLRSRNO,
USECD,
CHARCD,
RSWFCD,
ENTDAT,
THEIR,
ACTCLS,
HOLD,
NTCD,
IRCBFG,
HOLDAT,
NTAMT,
REMTYP,
REMBK,
REMSWFCD,
REMBKNM1,
REMBKNM2,
REMBKNM3,
VLDATE,
CLSDAT,
SDG.UFN_MASK_NM(RECNAM1),
SDG.UFN_MASK_NM(RECNAM2),
SDG.UFN_MASK_ADDR(RECADR1),
SDG.UFN_MASK_ADDR(RECADR2),
SDG.UFN_MASK_TEL(TELNO),
OPBRNO,
OPDAT,
FCEXP,
OSN,
RECSWFCD,
SDG.UFN_MASK_NM(REMNAM1),
SDG.UFN_MASK_NM(REMNAM2),
SDG.UFN_MASK_ACCT(REMTELNO),
XRATE,
TXTNO,
WSNO,
LASTDT,
TLRNO,
TXCD,
MT110,
SRNBK,
RCVBRH,
CHKNO,
CUSTOM,
CN,
EXAMT,
RECINFO,
NTXDAY,
CNGOODS,
CNTRYCD,
REMINF1,
REMINF2,
REMINF3,
REMINF4,
SDG.UFN_MASK_ADDR(REMADR1),
SDG.UFN_MASK_ADDR(REMADR2),
SDG.UFN_MASK_ADDR(REMADR3),
REMARK1,
REMARK2,
REMARK3,
REMARK4,
"690CODE",
NUSECDX,
UETR,
"33BCURNA",
"33B",
"71A",
"71FCUR",
"71FCUR2",
"71FCUR3",
"71FAMT",
"71FAMT2",
"71FAMT3",
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
