-- SQL for table: EDW_FXB_FRCEN_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
APTYPE,
BRNO,
SRNO,
KINBR,
BKCUR1,
BKSRNO1,
CURCD,
TXAMT,
TXDAT,
CKCNT,
COVER,
TXIDX,
CIFKEY_01,
CORPNO_01,
CBAMT_01,
USELN_01,
WSNO_01,
TXTNO_01,
USECD_01,
CUSTOM_01,
CN_01,
EXAMT_01,
CKKIND_01,
CIFKEY_02,
CORPNO_02,
CBAMT_02,
USELN_02,
WSNO_02,
TXTNO_02,
USECD_02,
CUSTOM_02,
CN_02,
EXAMT_02,
CKKIND_02,
CIFKEY_03,
CORPNO_03,
CBAMT_03,
USELN_03,
WSNO_03,
TXTNO_03,
USECD_03,
CUSTOM_03,
CN_03,
EXAMT_03,
CKKIND_03,
CIFKEY_04,
CORPNO_04,
CBAMT_04,
USELN_04,
WSNO_04,
TXTNO_04,
USECD_04,
CUSTOM_04,
CN_04,
EXAMT_04,
CKKIND_04,
CIFKEY_05,
CORPNO_05,
CBAMT_05,
USELN_05,
WSNO_05,
TXTNO_05,
USECD_05,
CUSTOM_05,
CN_05,
EXAMT_05,
CKKIND_05,
CIFKEY_06,
CORPNO_06,
CBAMT_06,
USELN_06,
WSNO_06,
TXTNO_06,
USECD_06,
CUSTOM_06,
CN_06,
EXAMT_06,
CKKIND_06,
CIFKEY_07,
CORPNO_07,
CBAMT_07,
USELN_07,
WSNO_07,
TXTNO_07,
USECD_07,
CUSTOM_07,
CN_07,
EXAMT_07,
CKKIND_07,
CIFKEY_08,
CORPNO_08,
CBAMT_08,
USELN_08,
WSNO_08,
TXTNO_08,
USECD_08,
CUSTOM_08,
CN_08,
EXAMT_08,
CKKIND_08,
CIFKEY_09,
CORPNO_09,
CBAMT_09,
USELN_09,
WSNO_09,
TXTNO_09,
USECD_09,
CUSTOM_09,
CN_09,
EXAMT_09,
CKKIND_09,
CIFKEY_10,
CORPNO_10,
CBAMT_10,
USELN_10,
WSNO_10,
TXTNO_10,
USECD_10,
CUSTOM_10,
CN_10,
EXAMT_10,
CKKIND_10,
CIFKEY_11,
CORPNO_11,
CBAMT_11,
USELN_11,
WSNO_11,
TXTNO_11,
USECD_11,
CUSTOM_11,
CN_11,
EXAMT_11,
CKKIND_11,
CIFKEY_12,
CORPNO_12,
CBAMT_12,
USELN_12,
WSNO_12,
TXTNO_12,
USECD_12,
CUSTOM_12,
CN_12,
EXAMT_12,
CKKIND_12,
CIFKEY_13,
CORPNO_13,
CBAMT_13,
USELN_13,
WSNO_13,
TXTNO_13,
USECD_13,
CUSTOM_13,
CN_13,
EXAMT_13,
CKKIND_13,
CIFKEY_14,
CORPNO_14,
CBAMT_14,
USELN_14,
WSNO_14,
TXTNO_14,
USECD_14,
CUSTOM_14,
CN_14,
EXAMT_14,
CKKIND_14,
CIFKEY_15,
CORPNO_15,
CBAMT_15,
USELN_15,
WSNO_15,
TXTNO_15,
USECD_15,
CUSTOM_15,
CN_15,
EXAMT_15,
CKKIND_15,
CIFKEY_16,
CORPNO_16,
CBAMT_16,
USELN_16,
WSNO_16,
TXTNO_16,
USECD_16,
CUSTOM_16,
CN_16,
EXAMT_16,
CKKIND_16,
CIFKEY_17,
CORPNO_17,
CBAMT_17,
USELN_17,
WSNO_17,
TXTNO_17,
USECD_17,
CUSTOM_17,
CN_17,
EXAMT_17,
CKKIND_17,
CIFKEY_18,
CORPNO_18,
CBAMT_18,
USELN_18,
WSNO_18,
TXTNO_18,
USECD_18,
CUSTOM_18,
CN_18,
EXAMT_18,
CKKIND_18,
CIFKEY_19,
CORPNO_19,
CBAMT_19,
USELN_19,
WSNO_19,
TXTNO_19,
USECD_19,
CUSTOM_19,
CN_19,
EXAMT_19,
CKKIND_19,
CIFKEY_20,
CORPNO_20,
CBAMT_20,
USELN_20,
WSNO_20,
TXTNO_20,
USECD_20,
CUSTOM_20,
CN_20,
EXAMT_20,
CKKIND_20,
CIFKEY_21,
CORPNO_21,
CBAMT_21,
USELN_21,
WSNO_21,
TXTNO_21,
USECD_21,
CUSTOM_21,
CN_21,
EXAMT_21,
CKKIND_21,
CIFKEY_22,
CORPNO_22,
CBAMT_22,
USELN_22,
WSNO_22,
TXTNO_22,
USECD_22,
CUSTOM_22,
CN_22,
EXAMT_22,
CKKIND_22,
CIFKEY_23,
CORPNO_23,
CBAMT_23,
USELN_23,
WSNO_23,
TXTNO_23,
USECD_23,
CUSTOM_23,
CN_23,
EXAMT_23,
CKKIND_23,
CIFKEY_24,
CORPNO_24,
CBAMT_24,
USELN_24,
WSNO_24,
TXTNO_24,
USECD_24,
CUSTOM_24,
CN_24,
EXAMT_24,
CKKIND_24,
CIFKEY_25,
CORPNO_25,
CBAMT_25,
USELN_25,
WSNO_25,
TXTNO_25,
USECD_25,
CUSTOM_25,
CN_25,
EXAMT_25,
CKKIND_25,
CIFKEY_26,
CORPNO_26,
CBAMT_26,
USELN_26,
WSNO_26,
TXTNO_26,
USECD_26,
CUSTOM_26,
CN_26,
EXAMT_26,
CKKIND_26,
CIFKEY_27,
CORPNO_27,
CBAMT_27,
USELN_27,
WSNO_27,
TXTNO_27,
USECD_27,
CUSTOM_27,
CN_27,
EXAMT_27,
CKKIND_27,
CIFKEY_28,
CORPNO_28,
CBAMT_28,
USELN_28,
WSNO_28,
TXTNO_28,
USECD_28,
CUSTOM_28,
CN_28,
EXAMT_28,
CKKIND_28,
CIFKEY_29,
CORPNO_29,
CBAMT_29,
USELN_29,
WSNO_29,
TXTNO_29,
USECD_29,
CUSTOM_29,
CN_29,
EXAMT_29,
CKKIND_29,
CIFKEY_30,
CORPNO_30,
CBAMT_30,
USELN_30,
WSNO_30,
TXTNO_30,
USECD_30,
CUSTOM_30,
CN_30,
EXAMT_30,
CKKIND_30,
EXPAMT,
USDAREA,
RCKIND,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
APTYPE,
BRNO,
SRNO,
KINBR,
BKCUR1,
BKSRNO1,
CURCD,
TXAMT,
TXDAT,
CKCNT,
COVER,
TXIDX,
SDG.UFN_MASK_BAN(CIFKEY_01),
CORPNO_01,
CBAMT_01,
USELN_01,
WSNO_01,
TXTNO_01,
USECD_01,
CUSTOM_01,
CN_01,
EXAMT_01,
CKKIND_01,
SDG.UFN_MASK_BAN(CIFKEY_02),
CORPNO_02,
CBAMT_02,
USELN_02,
WSNO_02,
TXTNO_02,
USECD_02,
CUSTOM_02,
CN_02,
EXAMT_02,
CKKIND_02,
SDG.UFN_MASK_BAN(CIFKEY_03),
CORPNO_03,
CBAMT_03,
USELN_03,
WSNO_03,
TXTNO_03,
USECD_03,
CUSTOM_03,
CN_03,
EXAMT_03,
CKKIND_03,
SDG.UFN_MASK_BAN(CIFKEY_04),
CORPNO_04,
CBAMT_04,
USELN_04,
WSNO_04,
TXTNO_04,
USECD_04,
CUSTOM_04,
CN_04,
EXAMT_04,
CKKIND_04,
SDG.UFN_MASK_BAN(CIFKEY_05),
CORPNO_05,
CBAMT_05,
USELN_05,
WSNO_05,
TXTNO_05,
USECD_05,
CUSTOM_05,
CN_05,
EXAMT_05,
CKKIND_05,
SDG.UFN_MASK_BAN(CIFKEY_06),
CORPNO_06,
CBAMT_06,
USELN_06,
WSNO_06,
TXTNO_06,
USECD_06,
CUSTOM_06,
CN_06,
EXAMT_06,
CKKIND_06,
SDG.UFN_MASK_BAN(CIFKEY_07),
CORPNO_07,
CBAMT_07,
USELN_07,
WSNO_07,
TXTNO_07,
USECD_07,
CUSTOM_07,
CN_07,
EXAMT_07,
CKKIND_07,
SDG.UFN_MASK_BAN(CIFKEY_08),
CORPNO_08,
CBAMT_08,
USELN_08,
WSNO_08,
TXTNO_08,
USECD_08,
CUSTOM_08,
CN_08,
EXAMT_08,
CKKIND_08,
SDG.UFN_MASK_BAN(CIFKEY_09),
CORPNO_09,
CBAMT_09,
USELN_09,
WSNO_09,
TXTNO_09,
USECD_09,
CUSTOM_09,
CN_09,
EXAMT_09,
CKKIND_09,
SDG.UFN_MASK_BAN(CIFKEY_10),
CORPNO_10,
CBAMT_10,
USELN_10,
WSNO_10,
TXTNO_10,
USECD_10,
CUSTOM_10,
CN_10,
EXAMT_10,
CKKIND_10,
SDG.UFN_MASK_BAN(CIFKEY_11),
CORPNO_11,
CBAMT_11,
USELN_11,
WSNO_11,
TXTNO_11,
USECD_11,
CUSTOM_11,
CN_11,
EXAMT_11,
CKKIND_11,
SDG.UFN_MASK_BAN(CIFKEY_12),
CORPNO_12,
CBAMT_12,
USELN_12,
WSNO_12,
TXTNO_12,
USECD_12,
CUSTOM_12,
CN_12,
EXAMT_12,
CKKIND_12,
SDG.UFN_MASK_BAN(CIFKEY_13),
CORPNO_13,
CBAMT_13,
USELN_13,
WSNO_13,
TXTNO_13,
USECD_13,
CUSTOM_13,
CN_13,
EXAMT_13,
CKKIND_13,
SDG.UFN_MASK_BAN(CIFKEY_14),
CORPNO_14,
CBAMT_14,
USELN_14,
WSNO_14,
TXTNO_14,
USECD_14,
CUSTOM_14,
CN_14,
EXAMT_14,
CKKIND_14,
SDG.UFN_MASK_BAN(CIFKEY_15),
CORPNO_15,
CBAMT_15,
USELN_15,
WSNO_15,
TXTNO_15,
USECD_15,
CUSTOM_15,
CN_15,
EXAMT_15,
CKKIND_15,
SDG.UFN_MASK_BAN(CIFKEY_16),
CORPNO_16,
CBAMT_16,
USELN_16,
WSNO_16,
TXTNO_16,
USECD_16,
CUSTOM_16,
CN_16,
EXAMT_16,
CKKIND_16,
SDG.UFN_MASK_BAN(CIFKEY_17),
CORPNO_17,
CBAMT_17,
USELN_17,
WSNO_17,
TXTNO_17,
USECD_17,
CUSTOM_17,
CN_17,
EXAMT_17,
CKKIND_17,
SDG.UFN_MASK_BAN(CIFKEY_18),
CORPNO_18,
CBAMT_18,
USELN_18,
WSNO_18,
TXTNO_18,
USECD_18,
CUSTOM_18,
CN_18,
EXAMT_18,
CKKIND_18,
SDG.UFN_MASK_BAN(CIFKEY_19),
CORPNO_19,
CBAMT_19,
USELN_19,
WSNO_19,
TXTNO_19,
USECD_19,
CUSTOM_19,
CN_19,
EXAMT_19,
CKKIND_19,
SDG.UFN_MASK_BAN(CIFKEY_20),
CORPNO_20,
CBAMT_20,
USELN_20,
WSNO_20,
TXTNO_20,
USECD_20,
CUSTOM_20,
CN_20,
EXAMT_20,
CKKIND_20,
SDG.UFN_MASK_BAN(CIFKEY_21),
CORPNO_21,
CBAMT_21,
USELN_21,
WSNO_21,
TXTNO_21,
USECD_21,
CUSTOM_21,
CN_21,
EXAMT_21,
CKKIND_21,
SDG.UFN_MASK_BAN(CIFKEY_22),
CORPNO_22,
CBAMT_22,
USELN_22,
WSNO_22,
TXTNO_22,
USECD_22,
CUSTOM_22,
CN_22,
EXAMT_22,
CKKIND_22,
SDG.UFN_MASK_BAN(CIFKEY_23),
CORPNO_23,
CBAMT_23,
USELN_23,
WSNO_23,
TXTNO_23,
USECD_23,
CUSTOM_23,
CN_23,
EXAMT_23,
CKKIND_23,
SDG.UFN_MASK_BAN(CIFKEY_24),
CORPNO_24,
CBAMT_24,
USELN_24,
WSNO_24,
TXTNO_24,
USECD_24,
CUSTOM_24,
CN_24,
EXAMT_24,
CKKIND_24,
SDG.UFN_MASK_BAN(CIFKEY_25),
CORPNO_25,
CBAMT_25,
USELN_25,
WSNO_25,
TXTNO_25,
USECD_25,
CUSTOM_25,
CN_25,
EXAMT_25,
CKKIND_25,
SDG.UFN_MASK_BAN(CIFKEY_26),
CORPNO_26,
CBAMT_26,
USELN_26,
WSNO_26,
TXTNO_26,
USECD_26,
CUSTOM_26,
CN_26,
EXAMT_26,
CKKIND_26,
SDG.UFN_MASK_BAN(CIFKEY_27),
CORPNO_27,
CBAMT_27,
USELN_27,
WSNO_27,
TXTNO_27,
USECD_27,
CUSTOM_27,
CN_27,
EXAMT_27,
CKKIND_27,
SDG.UFN_MASK_BAN(CIFKEY_28),
CORPNO_28,
CBAMT_28,
USELN_28,
WSNO_28,
TXTNO_28,
USECD_28,
CUSTOM_28,
CN_28,
EXAMT_28,
CKKIND_28,
SDG.UFN_MASK_BAN(CIFKEY_29),
CORPNO_29,
CBAMT_29,
USELN_29,
WSNO_29,
TXTNO_29,
USECD_29,
CUSTOM_29,
CN_29,
EXAMT_29,
CKKIND_29,
SDG.UFN_MASK_BAN(CIFKEY_30),
CORPNO_30,
CBAMT_30,
USELN_30,
WSNO_30,
TXTNO_30,
USECD_30,
CUSTOM_30,
CN_30,
EXAMT_30,
CKKIND_30,
EXPAMT,
USDAREA,
RCKIND,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
