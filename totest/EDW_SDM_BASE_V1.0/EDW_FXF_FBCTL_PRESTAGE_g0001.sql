-- SQL for table: EDW_FXF_FBCTL_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
BRNO,
FXLVL,
ACBRNO,
FBRNO,
TAKFG_01,
TAKFG_02,
TAKFG_03,
TAKFG_04,
TAKFG_05,
TAKFG_06,
TAKFG_07,
TAKFG_08,
TAKFG_09,
TAKFG_10,
RELFG_01,
RELFG_02,
RELFG_03,
RELFG_04,
RELFG_05,
RELFG_06,
RELFG_07,
RELFG_08,
RELFG_09,
RELFG_10,
MANFG,
XCRFG,
TXDRDY,
HOLDFG,
MODYFG,
KINBR,
TLRNO,
BRNAME,
BRADDR1,
BRADDR2,
BRSWFCD,
BRTELEX,
ADAREA,
ADTEL,
ADAREA1,
ADTEL1,
BCURCD,
BRCODE,
INQCODE,
CLSCD,
SPLFG,
ONFG,
LBSDY,
BKINF,
EXDT,
FFBAS,
OBUREL,
FXDCLCNT,
AESON,
FXDCLCNT2,
ATMFG,
ATMBIO,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
BRNO,
FXLVL,
ACBRNO,
FBRNO,
TAKFG_01,
TAKFG_02,
TAKFG_03,
TAKFG_04,
TAKFG_05,
TAKFG_06,
TAKFG_07,
TAKFG_08,
TAKFG_09,
TAKFG_10,
RELFG_01,
RELFG_02,
RELFG_03,
RELFG_04,
RELFG_05,
RELFG_06,
RELFG_07,
RELFG_08,
RELFG_09,
RELFG_10,
MANFG,
XCRFG,
TXDRDY,
HOLDFG,
MODYFG,
KINBR,
TLRNO,
BRNAME,
BRADDR1,
BRADDR2,
BRSWFCD,
BRTELEX,
ADAREA,
ADTEL,
ADAREA1,
ADTEL1,
BCURCD,
BRCODE,
INQCODE,
CLSCD,
SPLFG,
ONFG,
LBSDY,
BKINF,
EXDT,
FFBAS,
OBUREL,
FXDCLCNT,
AESON,
FXDCLCNT2,
ATMFG,
ATMBIO,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
