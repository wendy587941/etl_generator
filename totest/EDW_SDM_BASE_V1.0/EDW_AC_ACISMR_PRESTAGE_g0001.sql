-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Prestage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Stage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_AC_ACISMR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YEAR,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
CRDB,
LYBAL,
LMBAL,
SBCD_1,
SBCD_2,
SBCD_3,
SBCD_4,
SBCD_5,
SBCD_6,
SBCD_7,
SBCD_8,
SBCD_9,
SBCD_10,
SBCD_11,
SBCD_12,
DTLCD_1,
DTLCD_2,
DTLCD_3,
DTLCD_4,
DTLCD_5,
DTLCD_6,
DTLCD_7,
DTLCD_8,
DTLCD_9,
DTLCD_10,
DTLCD_11,
DTLCD_12,
TMBAL_1,
TMBAL_2,
TMBAL_3,
TMBAL_4,
TMBAL_5,
TMBAL_6,
TMBAL_7,
TMBAL_8,
TMBAL_9,
TMBAL_10,
TMBAL_11,
TMBAL_12,
DBCNT_1,
DBCNT_2,
DBCNT_3,
DBCNT_4,
DBCNT_5,
DBCNT_6,
DBCNT_7,
DBCNT_8,
DBCNT_9,
DBCNT_10,
DBCNT_11,
DBCNT_12,
DBAMT_1,
DBAMT_2,
DBAMT_3,
DBAMT_4,
DBAMT_5,
DBAMT_6,
DBAMT_7,
DBAMT_8,
DBAMT_9,
DBAMT_10,
DBAMT_11,
DBAMT_12,
CRCNT_1,
CRCNT_2,
CRCNT_3,
CRCNT_4,
CRCNT_5,
CRCNT_6,
CRCNT_7,
CRCNT_8,
CRCNT_9,
CRCNT_10,
CRCNT_11,
CRCNT_12,
CRAMT_1,
CRAMT_2,
CRAMT_3,
CRAMT_4,
CRAMT_5,
CRAMT_6,
CRAMT_7,
CRAMT_8,
CRAMT_9,
CRAMT_10,
CRAMT_11,
CRAMT_12,
BAL_1,
BAL_2,
BAL_3,
BAL_4,
BAL_5,
BAL_6,
BAL_7,
BAL_8,
BAL_9,
BAL_10,
BAL_11,
BAL_12,
TOTBAL_1,
TOTBAL_2,
TOTBAL_3,
TOTBAL_4,
TOTBAL_5,
TOTBAL_6,
TOTBAL_7,
TOTBAL_8,
TOTBAL_9,
TOTBAL_10,
TOTBAL_11,
TOTBAL_12,
AVGBAL_1,
AVGBAL_2,
AVGBAL_3,
AVGBAL_4,
AVGBAL_5,
AVGBAL_6,
AVGBAL_7,
AVGBAL_8,
AVGBAL_9,
AVGBAL_10,
AVGBAL_11,
AVGBAL_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
