-- SQL for table: EDW_IC_CARD_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
ACTNO,
SEQ,
CDKIND,
BIRTHDY,
PIDNO,
ICAP01,
ICAP02,
ICAP03,
ICAP04,
ICAP05,
ICAP06,
ICAP07,
ICAP08,
ICAP09,
ICAP10,
ICAP11,
ICAP12,
ICAP13,
ICAP14,
ICAP15,
ICAP16,
ICAP17,
ICAP18,
ICAP19,
ICAP20,
APEXDT01,
APEXDT02,
APEXDT03,
APEXDT04,
APEXDT05,
APEXDT06,
APEXDT07,
APEXDT08,
APEXDT09,
APEXDT10,
APEXDT11,
APEXDT12,
APEXDT13,
APEXDT14,
APEXDT15,
APEXDT16,
APEXDT17,
APEXDT18,
APEXDT19,
APEXDT20,
CDSTUS,
STUSDT,
STUSTM,
WSNO,
TLRNO,
HOTTYPE,
UNLKFG,
PREFG,
APPSEQ,
LANGUAGE,
USEDT,
KINBR,
APPTLRNO,
FEECD,
APPDT,
DIVTYPE,
EMPCARD,
EMPNO,
ITEM1,
ITEM2,
ITEM3,
ITEM4,
ITEM5,
ITEM6,
DESCHIP,
CREDIT,
BRNO,
"NEW",
CIRRUS,
DUEDT,
RCVDT,
COMBOSEQ,
PRCSB,
PRCNO,
MADFG,
MADAY,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
ME10.銀行帳號,
SEQ,
CDKIND,
ME5.出生年月日,
ME3.身份證號,
ICAP01,
ICAP02,
ICAP03,
ICAP04,
ICAP05,
ICAP06,
ICAP07,
ICAP08,
ICAP09,
ICAP10,
ICAP11,
ICAP12,
ICAP13,
ICAP14,
ICAP15,
ICAP16,
ICAP17,
ICAP18,
ICAP19,
ICAP20,
APEXDT01,
APEXDT02,
APEXDT03,
APEXDT04,
APEXDT05,
APEXDT06,
APEXDT07,
APEXDT08,
APEXDT09,
APEXDT10,
APEXDT11,
APEXDT12,
APEXDT13,
APEXDT14,
APEXDT15,
APEXDT16,
APEXDT17,
APEXDT18,
APEXDT19,
APEXDT20,
CDSTUS,
STUSDT,
STUSTM,
WSNO,
TLRNO,
HOTTYPE,
UNLKFG,
PREFG,
APPSEQ,
LANGUAGE,
USEDT,
KINBR,
APPTLRNO,
FEECD,
APPDT,
DIVTYPE,
EMPCARD,
EMPNO,
ITEM1,
ITEM2,
ITEM3,
ITEM4,
ITEM5,
ITEM6,
DESCHIP,
ME9.信用卡號,
BRNO,
"NEW",
CIRRUS,
DUEDT,
RCVDT,
COMBOSEQ,
PRCSB,
PRCNO,
MADFG,
MADAY,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
