-- SQL for table: EDW_LNL_LLCON_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
BRNO,
APNO,
SRNO,
CHKDG,
PIDNO,
PIDERR,
ENTPNO,
EIDERR,
SAPNO,
LNCUR,
CHARCD,
BCODE,
CONAMT,
MSTLMT,
ULNLMT,
ACTBAL,
ARVAMT,
SHARCD,
"USAGE",
"SOURCE",
LNTYP,
MANG,
PRM,
CYCLE,
LNDOC,
CPCNT,
CSDATE,
CEDATE,
RGDAY,
ODDATE,
LASTDT,
NUMEDT,
RATDT,
LUSPR,
ODCD,
EXDATE,
ACTCLS,
IPACTNO,
DMCD,
TRUCD,
TRUNO,
APIVCD,
ISTSCD,
UPPRI,
SGAPER,
SGAID,
SCOP,
PER,
"LIMIT",
APCD,
APACT,
PAYACT,
OACTNO,
TRPACT,
DLCCD,
OGNAME,
OTHCHG,
TFBRNO,
TFRATE,
CBCNO,
BSID,
BSCD,
APSQNO,
UNSQNO,
INTSQ,
NTIRT,
CNIRT,
TFIRT,
INTTOT,
ODITOT,
DFTOT,
CHGTOT,
INTCD,
INTTM,
NIDATE,
OIDATE,
IDATE,
PRCD,
PRTM,
NPRDT,
OPRDT,
PRDATE,
ISTPRT,
PRDTOT,
CLSPRD,
CNIRDT,
CNIRND,
CNIRCD,
CNIRID,
CNIXPR,
CNIXID,
NTIRDT,
NTIRND,
NTIRCD,
NTIRID,
NTIXPR,
NTIXID,
TFIRDT,
TFIRND,
TFIRCD,
TFIRID,
TFIXPR,
TFIXID,
MIDNO,
MAPCD,
MCURCD,
TELNO,
SHARID,
PLDOC,
NOIDT,
INTID,
PRID,
TFCURR,
SQICD,
APRCD,
DAY30,
FILLER,
APKIND,
ACCUBAL,
ACCUAC,
ACCULN,
ACCUDT,
PERCENT,
SPIXPR,
SIRND,
UIRTCD,
UCHGRT,
UIXPR,
UFITIRT,
PLCKIND,
NEWCD,
FINA,
FITDIV,
AGBRNO,
CONTYP,
IREVOCB,
DEPNO,
CBRNO,
YEAR,
CSRNO,
SEQNO,
RSKNAL,
IRATDT,
PRCD9,
INTCD9,
RSKAMT,
GDCNT,
CNFLG,
NTXDAY,
TWLODG,
LENTPNO,
LFILLER,
LMTGNO,
LMTGDT,
LMTGNT,
ULNFEE,
USECD,
MININT,
LOVENTP,
LOVSIXPR,
LOVIXPR,
DWELLING,
OTHCPPER,
PLCKIND2,
PLCKIND3,
PLCKIND4,
PLCKIND5,
PLCKIND6,
ULNPER,
TRANS,
FUNDUSE,
LOWCHARGE,
ABCPCNT,
MICRO,
PRPER,
BUILDCD,
BUILDDAY,
SGADATE,
CHANGECD,
REGION,
ELOANNO,
BKACT,
BYCD,
BYOTHER,
BNCD,
BNOTHER,
CTLFG,
AREA,
CNFLG2,
CNUSE,
CNGUAR,
LCOLLD,
NDSTR,
APPRV,
DEUSE,
RECYY,
MOEACODE,
LKBKDAYS,
COMPOUND,
NTRURT,
UACTNO,
TACTNO,
ODCD65,
LNSGCD,
JCICLS,
JCRGDT,
COMMIT,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
BRNO,
APNO,
SDG.UFN_MASK_ACCT_SN(SRNO),
CHKDG,
CASE WHEN LENGTH(PIDNO) = 8 THEN SDG.UFN_MASK_BAN(PIDNO) WHEN LENGTH(PIDNO) = 10 THEN SDG.UFN_MASK_IDN(PIDNO) END,
PIDERR,
SDG.UFN_MASK_BAN(ENTPNO),
EIDERR,
SAPNO,
LNCUR,
CHARCD,
BCODE,
CONAMT,
MSTLMT,
ULNLMT,
ACTBAL,
ARVAMT,
SHARCD,
"USAGE",
"SOURCE",
LNTYP,
MANG,
PRM,
CYCLE,
LNDOC,
CPCNT,
CSDATE,
CEDATE,
RGDAY,
ODDATE,
LASTDT,
NUMEDT,
RATDT,
LUSPR,
ODCD,
EXDATE,
ACTCLS,
SDG.UFN_MASK_ACCT(IPACTNO),
DMCD,
TRUCD,
TRUNO,
APIVCD,
ISTSCD,
UPPRI,
SGAPER,
SGAID,
SCOP,
PER,
"LIMIT",
APCD,
SDG.UFN_MASK_ACCT(APACT),
SDG.UFN_MASK_ACCT(PAYACT),
SDG.UFN_MASK_ACCT(OACTNO),
SDG.UFN_MASK_ACCT(TRPACT),
DLCCD,
OGNAME,
OTHCHG,
TFBRNO,
TFRATE,
CBCNO,
SDG.UFN_MASK_BAN(BSID),
BSCD,
APSQNO,
UNSQNO,
INTSQ,
NTIRT,
CNIRT,
TFIRT,
INTTOT,
ODITOT,
DFTOT,
CHGTOT,
INTCD,
INTTM,
NIDATE,
OIDATE,
IDATE,
PRCD,
PRTM,
NPRDT,
OPRDT,
PRDATE,
ISTPRT,
PRDTOT,
CLSPRD,
CNIRDT,
CNIRND,
CNIRCD,
CNIRID,
CNIXPR,
CNIXID,
NTIRDT,
NTIRND,
NTIRCD,
NTIRID,
NTIXPR,
NTIXID,
TFIRDT,
TFIRND,
TFIRCD,
TFIRID,
TFIXPR,
TFIXID,
MIDNO,
MAPCD,
MCURCD,
TELNO,
SHARID,
PLDOC,
NOIDT,
INTID,
PRID,
TFCURR,
SQICD,
APRCD,
DAY30,
FILLER,
APKIND,
ACCUBAL,
ACCUAC,
ACCULN,
ACCUDT,
PERCENT,
SPIXPR,
SIRND,
UIRTCD,
UCHGRT,
UIXPR,
UFITIRT,
PLCKIND,
NEWCD,
FINA,
FITDIV,
AGBRNO,
CONTYP,
IREVOCB,
DEPNO,
CBRNO,
YEAR,
CSRNO,
SEQNO,
RSKNAL,
IRATDT,
PRCD9,
INTCD9,
RSKAMT,
GDCNT,
CNFLG,
NTXDAY,
TWLODG,
LENTPNO,
LFILLER,
LMTGNO,
LMTGDT,
LMTGNT,
ULNFEE,
USECD,
MININT,
LOVENTP,
LOVSIXPR,
LOVIXPR,
DWELLING,
OTHCPPER,
PLCKIND2,
PLCKIND3,
PLCKIND4,
PLCKIND5,
PLCKIND6,
ULNPER,
TRANS,
FUNDUSE,
LOWCHARGE,
ABCPCNT,
MICRO,
PRPER,
BUILDCD,
BUILDDAY,
SGADATE,
CHANGECD,
REGION,
ELOANNO,
BKACT,
BYCD,
BYOTHER,
BNCD,
BNOTHER,
CTLFG,
AREA,
CNFLG2,
CNUSE,
CNGUAR,
LCOLLD,
NDSTR,
APPRV,
DEUSE,
RECYY,
MOEACODE,
LKBKDAYS,
COMPOUND,
NTRURT,
UACTNO,
TACTNO,
ODCD65,
LNSGCD,
JCICLS,
JCRGDT,
COMMIT,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
