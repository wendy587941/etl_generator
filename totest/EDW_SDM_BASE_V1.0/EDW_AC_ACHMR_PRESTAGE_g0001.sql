-- SQL for table: EDW_AC_ACHMR_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
YYMM,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
SBCD,
DTLCD,
CRDB,
LMBAL,
YDBAL_01,
TDBAL_01,
CDCNT_01,
CDAMT_01,
CCCNT_01,
CCAMT_01,
MDCNT_01,
MDAMT_01,
MCCNT_01,
MCAMT_01,
TDCNT_01,
TDAMT_01,
TCCNT_01,
TCAMT_01,
MTRCNT_01,
YDBAL_02,
TDBAL_02,
CDCNT_02,
CDAMT_02,
CCCNT_02,
CCAMT_02,
MDCNT_02,
MDAMT_02,
MCCNT_02,
MCAMT_02,
TDCNT_02,
TDAMT_02,
TCCNT_02,
TCAMT_02,
MTRCNT_02,
YDBAL_03,
TDBAL_03,
CDCNT_03,
CDAMT_03,
CCCNT_03,
CCAMT_03,
MDCNT_03,
MDAMT_03,
MCCNT_03,
MCAMT_03,
TDCNT_03,
TDAMT_03,
TCCNT_03,
TCAMT_03,
MTRCNT_03,
YDBAL_04,
TDBAL_04,
CDCNT_04,
CDAMT_04,
CCCNT_04,
CCAMT_04,
MDCNT_04,
MDAMT_04,
MCCNT_04,
MCAMT_04,
TDCNT_04,
TDAMT_04,
TCCNT_04,
TCAMT_04,
MTRCNT_04,
YDBAL_05,
TDBAL_05,
CDCNT_05,
CDAMT_05,
CCCNT_05,
CCAMT_05,
MDCNT_05,
MDAMT_05,
MCCNT_05,
MCAMT_05,
TDCNT_05,
TDAMT_05,
TCCNT_05,
TCAMT_05,
MTRCNT_05,
YDBAL_06,
TDBAL_06,
CDCNT_06,
CDAMT_06,
CCCNT_06,
CCAMT_06,
MDCNT_06,
MDAMT_06,
MCCNT_06,
MCAMT_06,
TDCNT_06,
TDAMT_06,
TCCNT_06,
TCAMT_06,
MTRCNT_06,
YDBAL_07,
TDBAL_07,
CDCNT_07,
CDAMT_07,
CCCNT_07,
CCAMT_07,
MDCNT_07,
MDAMT_07,
MCCNT_07,
MCAMT_07,
TDCNT_07,
TDAMT_07,
TCCNT_07,
TCAMT_07,
MTRCNT_07,
YDBAL_08,
TDBAL_08,
CDCNT_08,
CDAMT_08,
CCCNT_08,
CCAMT_08,
MDCNT_08,
MDAMT_08,
MCCNT_08,
MCAMT_08,
TDCNT_08,
TDAMT_08,
TCCNT_08,
TCAMT_08,
MTRCNT_08,
YDBAL_09,
TDBAL_09,
CDCNT_09,
CDAMT_09,
CCCNT_09,
CCAMT_09,
MDCNT_09,
MDAMT_09,
MCCNT_09,
MCAMT_09,
TDCNT_09,
TDAMT_09,
TCCNT_09,
TCAMT_09,
MTRCNT_09,
YDBAL_10,
TDBAL_10,
CDCNT_10,
CDAMT_10,
CCCNT_10,
CCAMT_10,
MDCNT_10,
MDAMT_10,
MCCNT_10,
MCAMT_10,
TDCNT_10,
TDAMT_10,
TCCNT_10,
TCAMT_10,
MTRCNT_10,
YDBAL_11,
TDBAL_11,
CDCNT_11,
CDAMT_11,
CCCNT_11,
CCAMT_11,
MDCNT_11,
MDAMT_11,
MCCNT_11,
MCAMT_11,
TDCNT_11,
TDAMT_11,
TCCNT_11,
TCAMT_11,
MTRCNT_11,
YDBAL_12,
TDBAL_12,
CDCNT_12,
CDAMT_12,
CCCNT_12,
CCAMT_12,
MDCNT_12,
MDAMT_12,
MCCNT_12,
MCAMT_12,
TDCNT_12,
TDAMT_12,
TCCNT_12,
TCAMT_12,
MTRCNT_12,
YDBAL_13,
TDBAL_13,
CDCNT_13,
CDAMT_13,
CCCNT_13,
CCAMT_13,
MDCNT_13,
MDAMT_13,
MCCNT_13,
MCAMT_13,
TDCNT_13,
TDAMT_13,
TCCNT_13,
TCAMT_13,
MTRCNT_13,
YDBAL_14,
TDBAL_14,
CDCNT_14,
CDAMT_14,
CCCNT_14,
CCAMT_14,
MDCNT_14,
MDAMT_14,
MCCNT_14,
MCAMT_14,
TDCNT_14,
TDAMT_14,
TCCNT_14,
TCAMT_14,
MTRCNT_14,
YDBAL_15,
TDBAL_15,
CDCNT_15,
CDAMT_15,
CCCNT_15,
CCAMT_15,
MDCNT_15,
MDAMT_15,
MCCNT_15,
MCAMT_15,
TDCNT_15,
TDAMT_15,
TCCNT_15,
TCAMT_15,
MTRCNT_15,
YDBAL_16,
TDBAL_16,
CDCNT_16,
CDAMT_16,
CCCNT_16,
CCAMT_16,
MDCNT_16,
MDAMT_16,
MCCNT_16,
MCAMT_16,
TDCNT_16,
TDAMT_16,
TCCNT_16,
TCAMT_16,
MTRCNT_16,
YDBAL_17,
TDBAL_17,
CDCNT_17,
CDAMT_17,
CCCNT_17,
CCAMT_17,
MDCNT_17,
MDAMT_17,
MCCNT_17,
MCAMT_17,
TDCNT_17,
TDAMT_17,
TCCNT_17,
TCAMT_17,
MTRCNT_17,
YDBAL_18,
TDBAL_18,
CDCNT_18,
CDAMT_18,
CCCNT_18,
CCAMT_18,
MDCNT_18,
MDAMT_18,
MCCNT_18,
MCAMT_18,
TDCNT_18,
TDAMT_18,
TCCNT_18,
TCAMT_18,
MTRCNT_18,
YDBAL_19,
TDBAL_19,
CDCNT_19,
CDAMT_19,
CCCNT_19,
CCAMT_19,
MDCNT_19,
MDAMT_19,
MCCNT_19,
MCAMT_19,
TDCNT_19,
TDAMT_19,
TCCNT_19,
TCAMT_19,
MTRCNT_19,
YDBAL_20,
TDBAL_20,
CDCNT_20,
CDAMT_20,
CCCNT_20,
CCAMT_20,
MDCNT_20,
MDAMT_20,
MCCNT_20,
MCAMT_20,
TDCNT_20,
TDAMT_20,
TCCNT_20,
TCAMT_20,
MTRCNT_20,
YDBAL_21,
TDBAL_21,
CDCNT_21,
CDAMT_21,
CCCNT_21,
CCAMT_21,
MDCNT_21,
MDAMT_21,
MCCNT_21,
MCAMT_21,
TDCNT_21,
TDAMT_21,
TCCNT_21,
TCAMT_21,
MTRCNT_21,
YDBAL_22,
TDBAL_22,
CDCNT_22,
CDAMT_22,
CCCNT_22,
CCAMT_22,
MDCNT_22,
MDAMT_22,
MCCNT_22,
MCAMT_22,
TDCNT_22,
TDAMT_22,
TCCNT_22,
TCAMT_22,
MTRCNT_22,
YDBAL_23,
TDBAL_23,
CDCNT_23,
CDAMT_23,
CCCNT_23,
CCAMT_23,
MDCNT_23,
MDAMT_23,
MCCNT_23,
MCAMT_23,
TDCNT_23,
TDAMT_23,
TCCNT_23,
TCAMT_23,
MTRCNT_23,
YDBAL_24,
TDBAL_24,
CDCNT_24,
CDAMT_24,
CCCNT_24,
CCAMT_24,
MDCNT_24,
MDAMT_24,
MCCNT_24,
MCAMT_24,
TDCNT_24,
TDAMT_24,
TCCNT_24,
TCAMT_24,
MTRCNT_24,
YDBAL_25,
TDBAL_25,
CDCNT_25,
CDAMT_25,
CCCNT_25,
CCAMT_25,
MDCNT_25,
MDAMT_25,
MCCNT_25,
MCAMT_25,
TDCNT_25,
TDAMT_25,
TCCNT_25,
TCAMT_25,
MTRCNT_25,
YDBAL_26,
TDBAL_26,
CDCNT_26,
CDAMT_26,
CCCNT_26,
CCAMT_26,
MDCNT_26,
MDAMT_26,
MCCNT_26,
MCAMT_26,
TDCNT_26,
TDAMT_26,
TCCNT_26,
TCAMT_26,
MTRCNT_26,
YDBAL_27,
TDBAL_27,
CDCNT_27,
CDAMT_27,
CCCNT_27,
CCAMT_27,
MDCNT_27,
MDAMT_27,
MCCNT_27,
MCAMT_27,
TDCNT_27,
TDAMT_27,
TCCNT_27,
TCAMT_27,
MTRCNT_27,
YDBAL_28,
TDBAL_28,
CDCNT_28,
CDAMT_28,
CCCNT_28,
CCAMT_28,
MDCNT_28,
MDAMT_28,
MCCNT_28,
MCAMT_28,
TDCNT_28,
TDAMT_28,
TCCNT_28,
TCAMT_28,
MTRCNT_28,
YDBAL_29,
TDBAL_29,
CDCNT_29,
CDAMT_29,
CCCNT_29,
CCAMT_29,
MDCNT_29,
MDAMT_29,
MCCNT_29,
MCAMT_29,
TDCNT_29,
TDAMT_29,
TCCNT_29,
TCAMT_29,
MTRCNT_29,
YDBAL_30,
TDBAL_30,
CDCNT_30,
CDAMT_30,
CCCNT_30,
CCAMT_30,
MDCNT_30,
MDAMT_30,
MCCNT_30,
MCAMT_30,
TDCNT_30,
TDAMT_30,
TCCNT_30,
TCAMT_30,
MTRCNT_30,
YDBAL_31,
TDBAL_31,
CDCNT_31,
CDAMT_31,
CCCNT_31,
CCAMT_31,
MDCNT_31,
MDAMT_31,
MCCNT_31,
MCAMT_31,
TDCNT_31,
TDAMT_31,
TCCNT_31,
TCAMT_31,
MTRCNT_31,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
YYMM,
BRNO,
DEPT,
CURCD,
ACNO,
SBNO,
DTLNO,
SBCD,
DTLCD,
CRDB,
LMBAL,
YDBAL_01,
TDBAL_01,
CDCNT_01,
CDAMT_01,
CCCNT_01,
CCAMT_01,
MDCNT_01,
MDAMT_01,
MCCNT_01,
MCAMT_01,
TDCNT_01,
TDAMT_01,
TCCNT_01,
TCAMT_01,
MTRCNT_01,
YDBAL_02,
TDBAL_02,
CDCNT_02,
CDAMT_02,
CCCNT_02,
CCAMT_02,
MDCNT_02,
MDAMT_02,
MCCNT_02,
MCAMT_02,
TDCNT_02,
TDAMT_02,
TCCNT_02,
TCAMT_02,
MTRCNT_02,
YDBAL_03,
TDBAL_03,
CDCNT_03,
CDAMT_03,
CCCNT_03,
CCAMT_03,
MDCNT_03,
MDAMT_03,
MCCNT_03,
MCAMT_03,
TDCNT_03,
TDAMT_03,
TCCNT_03,
TCAMT_03,
MTRCNT_03,
YDBAL_04,
TDBAL_04,
CDCNT_04,
CDAMT_04,
CCCNT_04,
CCAMT_04,
MDCNT_04,
MDAMT_04,
MCCNT_04,
MCAMT_04,
TDCNT_04,
TDAMT_04,
TCCNT_04,
TCAMT_04,
MTRCNT_04,
YDBAL_05,
TDBAL_05,
CDCNT_05,
CDAMT_05,
CCCNT_05,
CCAMT_05,
MDCNT_05,
MDAMT_05,
MCCNT_05,
MCAMT_05,
TDCNT_05,
TDAMT_05,
TCCNT_05,
TCAMT_05,
MTRCNT_05,
YDBAL_06,
TDBAL_06,
CDCNT_06,
CDAMT_06,
CCCNT_06,
CCAMT_06,
MDCNT_06,
MDAMT_06,
MCCNT_06,
MCAMT_06,
TDCNT_06,
TDAMT_06,
TCCNT_06,
TCAMT_06,
MTRCNT_06,
YDBAL_07,
TDBAL_07,
CDCNT_07,
CDAMT_07,
CCCNT_07,
CCAMT_07,
MDCNT_07,
MDAMT_07,
MCCNT_07,
MCAMT_07,
TDCNT_07,
TDAMT_07,
TCCNT_07,
TCAMT_07,
MTRCNT_07,
YDBAL_08,
TDBAL_08,
CDCNT_08,
CDAMT_08,
CCCNT_08,
CCAMT_08,
MDCNT_08,
MDAMT_08,
MCCNT_08,
MCAMT_08,
TDCNT_08,
TDAMT_08,
TCCNT_08,
TCAMT_08,
MTRCNT_08,
YDBAL_09,
TDBAL_09,
CDCNT_09,
CDAMT_09,
CCCNT_09,
CCAMT_09,
MDCNT_09,
MDAMT_09,
MCCNT_09,
MCAMT_09,
TDCNT_09,
TDAMT_09,
TCCNT_09,
TCAMT_09,
MTRCNT_09,
YDBAL_10,
TDBAL_10,
CDCNT_10,
CDAMT_10,
CCCNT_10,
CCAMT_10,
MDCNT_10,
MDAMT_10,
MCCNT_10,
MCAMT_10,
TDCNT_10,
TDAMT_10,
TCCNT_10,
TCAMT_10,
MTRCNT_10,
YDBAL_11,
TDBAL_11,
CDCNT_11,
CDAMT_11,
CCCNT_11,
CCAMT_11,
MDCNT_11,
MDAMT_11,
MCCNT_11,
MCAMT_11,
TDCNT_11,
TDAMT_11,
TCCNT_11,
TCAMT_11,
MTRCNT_11,
YDBAL_12,
TDBAL_12,
CDCNT_12,
CDAMT_12,
CCCNT_12,
CCAMT_12,
MDCNT_12,
MDAMT_12,
MCCNT_12,
MCAMT_12,
TDCNT_12,
TDAMT_12,
TCCNT_12,
TCAMT_12,
MTRCNT_12,
YDBAL_13,
TDBAL_13,
CDCNT_13,
CDAMT_13,
CCCNT_13,
CCAMT_13,
MDCNT_13,
MDAMT_13,
MCCNT_13,
MCAMT_13,
TDCNT_13,
TDAMT_13,
TCCNT_13,
TCAMT_13,
MTRCNT_13,
YDBAL_14,
TDBAL_14,
CDCNT_14,
CDAMT_14,
CCCNT_14,
CCAMT_14,
MDCNT_14,
MDAMT_14,
MCCNT_14,
MCAMT_14,
TDCNT_14,
TDAMT_14,
TCCNT_14,
TCAMT_14,
MTRCNT_14,
YDBAL_15,
TDBAL_15,
CDCNT_15,
CDAMT_15,
CCCNT_15,
CCAMT_15,
MDCNT_15,
MDAMT_15,
MCCNT_15,
MCAMT_15,
TDCNT_15,
TDAMT_15,
TCCNT_15,
TCAMT_15,
MTRCNT_15,
YDBAL_16,
TDBAL_16,
CDCNT_16,
CDAMT_16,
CCCNT_16,
CCAMT_16,
MDCNT_16,
MDAMT_16,
MCCNT_16,
MCAMT_16,
TDCNT_16,
TDAMT_16,
TCCNT_16,
TCAMT_16,
MTRCNT_16,
YDBAL_17,
TDBAL_17,
CDCNT_17,
CDAMT_17,
CCCNT_17,
CCAMT_17,
MDCNT_17,
MDAMT_17,
MCCNT_17,
MCAMT_17,
TDCNT_17,
TDAMT_17,
TCCNT_17,
TCAMT_17,
MTRCNT_17,
YDBAL_18,
TDBAL_18,
CDCNT_18,
CDAMT_18,
CCCNT_18,
CCAMT_18,
MDCNT_18,
MDAMT_18,
MCCNT_18,
MCAMT_18,
TDCNT_18,
TDAMT_18,
TCCNT_18,
TCAMT_18,
MTRCNT_18,
YDBAL_19,
TDBAL_19,
CDCNT_19,
CDAMT_19,
CCCNT_19,
CCAMT_19,
MDCNT_19,
MDAMT_19,
MCCNT_19,
MCAMT_19,
TDCNT_19,
TDAMT_19,
TCCNT_19,
TCAMT_19,
MTRCNT_19,
YDBAL_20,
TDBAL_20,
CDCNT_20,
CDAMT_20,
CCCNT_20,
CCAMT_20,
MDCNT_20,
MDAMT_20,
MCCNT_20,
MCAMT_20,
TDCNT_20,
TDAMT_20,
TCCNT_20,
TCAMT_20,
MTRCNT_20,
YDBAL_21,
TDBAL_21,
CDCNT_21,
CDAMT_21,
CCCNT_21,
CCAMT_21,
MDCNT_21,
MDAMT_21,
MCCNT_21,
MCAMT_21,
TDCNT_21,
TDAMT_21,
TCCNT_21,
TCAMT_21,
MTRCNT_21,
YDBAL_22,
TDBAL_22,
CDCNT_22,
CDAMT_22,
CCCNT_22,
CCAMT_22,
MDCNT_22,
MDAMT_22,
MCCNT_22,
MCAMT_22,
TDCNT_22,
TDAMT_22,
TCCNT_22,
TCAMT_22,
MTRCNT_22,
YDBAL_23,
TDBAL_23,
CDCNT_23,
CDAMT_23,
CCCNT_23,
CCAMT_23,
MDCNT_23,
MDAMT_23,
MCCNT_23,
MCAMT_23,
TDCNT_23,
TDAMT_23,
TCCNT_23,
TCAMT_23,
MTRCNT_23,
YDBAL_24,
TDBAL_24,
CDCNT_24,
CDAMT_24,
CCCNT_24,
CCAMT_24,
MDCNT_24,
MDAMT_24,
MCCNT_24,
MCAMT_24,
TDCNT_24,
TDAMT_24,
TCCNT_24,
TCAMT_24,
MTRCNT_24,
YDBAL_25,
TDBAL_25,
CDCNT_25,
CDAMT_25,
CCCNT_25,
CCAMT_25,
MDCNT_25,
MDAMT_25,
MCCNT_25,
MCAMT_25,
TDCNT_25,
TDAMT_25,
TCCNT_25,
TCAMT_25,
MTRCNT_25,
YDBAL_26,
TDBAL_26,
CDCNT_26,
CDAMT_26,
CCCNT_26,
CCAMT_26,
MDCNT_26,
MDAMT_26,
MCCNT_26,
MCAMT_26,
TDCNT_26,
TDAMT_26,
TCCNT_26,
TCAMT_26,
MTRCNT_26,
YDBAL_27,
TDBAL_27,
CDCNT_27,
CDAMT_27,
CCCNT_27,
CCAMT_27,
MDCNT_27,
MDAMT_27,
MCCNT_27,
MCAMT_27,
TDCNT_27,
TDAMT_27,
TCCNT_27,
TCAMT_27,
MTRCNT_27,
YDBAL_28,
TDBAL_28,
CDCNT_28,
CDAMT_28,
CCCNT_28,
CCAMT_28,
MDCNT_28,
MDAMT_28,
MCCNT_28,
MCAMT_28,
TDCNT_28,
TDAMT_28,
TCCNT_28,
TCAMT_28,
MTRCNT_28,
YDBAL_29,
TDBAL_29,
CDCNT_29,
CDAMT_29,
CCCNT_29,
CCAMT_29,
MDCNT_29,
MDAMT_29,
MCCNT_29,
MCAMT_29,
TDCNT_29,
TDAMT_29,
TCCNT_29,
TCAMT_29,
MTRCNT_29,
YDBAL_30,
TDBAL_30,
CDCNT_30,
CDAMT_30,
CCCNT_30,
CCAMT_30,
MDCNT_30,
MDAMT_30,
MCCNT_30,
MCAMT_30,
TDCNT_30,
TDAMT_30,
TCCNT_30,
TCAMT_30,
MTRCNT_30,
YDBAL_31,
TDBAL_31,
CDCNT_31,
CDAMT_31,
CCCNT_31,
CCAMT_31,
MDCNT_31,
MDAMT_31,
MCCNT_31,
MCAMT_31,
TDCNT_31,
TDAMT_31,
TCCNT_31,
TCAMT_31,
MTRCNT_31,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
