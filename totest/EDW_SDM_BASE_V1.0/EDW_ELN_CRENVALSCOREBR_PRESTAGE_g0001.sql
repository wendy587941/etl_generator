-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1. Delete 目的表 Prestage data_exch_date = '#排程啟動日#' */
DELETE FROM ${TARGET_SCHEMA}.${TARGET_TABLE} WHERE DATA_EXCH_DATE = TO_DATE('${BD_EXCH_DATE}', 'yyyy-MM-dd');

-- Trinity SQL Script
/* 2. 抽取 Stage 同期別進行新增 */
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE DATA_EXCH_DATE = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
-- SQL for table: EDW_ELN_CRENVALSCOREBR_PRESTAGE
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

-- Trinity SQL Script
/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
CASEID,
IDBAN,
CRRPTNO,
INDUNO,
GRADEYEAR,
REMARKS,
BOTMARK,
BOTRANK,
OUTSIDEMARK,
OUTSIDERANK,
SCORE_01,
SCORE_02,
SCORE_03,
SCORE_04,
SCORE_05,
SCORE_06,
SCORE_07,
SCORE_08,
SCORE_09,
SCORE_10,
SCORE_11,
SCORE_12,
SCORE_13,
SCORE_14,
SCORE_15,
SCORE_16,
SCORE_17,
SCORE_18,
SCORE_19,
SCORE_20,
SCORE_21,
SCORE_22,
SCORE_23,
SCORE_24,
SCORE_25,
SCORE_26,
SCORE_27,
SCORE_28,
SCORE_29,
SCORE_30,
SCORE_31,
SCORE_32,
SCORE_33,
SCORE_34,
SCORE_35,
SCORE_36,
SCORE_37,
SCORE_38,
SCORE_39,
SCORE_40,
SCORE_41,
SCORE_42,
SCORE_43,
SCORE_44,
SCORE_45,
CRRPTER,
CRRPTDATE,
ENDDATE,
ENVALFLAG,
IND_GI,
BREACH,
BCDATE,
ISTDT,
ODDATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
