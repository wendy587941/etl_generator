-- SQL for table: EDW_FXF_CMMR_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
CIFKEY,
BRNO,
YEAR,
CEXAMT_1,
CEXAMT_2,
CEXAMT_3,
CEXAMT_4,
CEXAMT_5,
CEXAMT_6,
CEXAMT_7,
CEXAMT_8,
CEXAMT_9,
CEXAMT_10,
CEXAMT_11,
CEXAMT_12,
CEXCNT_1,
CEXCNT_2,
CEXCNT_3,
CEXCNT_4,
CEXCNT_5,
CEXCNT_6,
CEXCNT_7,
CEXCNT_8,
CEXCNT_9,
CEXCNT_10,
CEXCNT_11,
CEXCNT_12,
NEXAMT_1,
NEXAMT_2,
NEXAMT_3,
NEXAMT_4,
NEXAMT_5,
NEXAMT_6,
NEXAMT_7,
NEXAMT_8,
NEXAMT_9,
NEXAMT_10,
NEXAMT_11,
NEXAMT_12,
NEXCNT_1,
NEXCNT_2,
NEXCNT_3,
NEXCNT_4,
NEXCNT_5,
NEXCNT_6,
NEXCNT_7,
NEXCNT_8,
NEXCNT_9,
NEXCNT_10,
NEXCNT_11,
NEXCNT_12,
CIMAMT_1,
CIMAMT_2,
CIMAMT_3,
CIMAMT_4,
CIMAMT_5,
CIMAMT_6,
CIMAMT_7,
CIMAMT_8,
CIMAMT_9,
CIMAMT_10,
CIMAMT_11,
CIMAMT_12,
CIMCNT_1,
CIMCNT_2,
CIMCNT_3,
CIMCNT_4,
CIMCNT_5,
CIMCNT_6,
CIMCNT_7,
CIMCNT_8,
CIMCNT_9,
CIMCNT_10,
CIMCNT_11,
CIMCNT_12,
NIMAMT_1,
NIMAMT_2,
NIMAMT_3,
NIMAMT_4,
NIMAMT_5,
NIMAMT_6,
NIMAMT_7,
NIMAMT_8,
NIMAMT_9,
NIMAMT_10,
NIMAMT_11,
NIMAMT_12,
NIMCNT_1,
NIMCNT_2,
NIMCNT_3,
NIMCNT_4,
NIMCNT_5,
NIMCNT_6,
NIMCNT_7,
NIMCNT_8,
NIMCNT_9,
NIMCNT_10,
NIMCNT_11,
NIMCNT_12,
CIRAMT_1,
CIRAMT_2,
CIRAMT_3,
CIRAMT_4,
CIRAMT_5,
CIRAMT_6,
CIRAMT_7,
CIRAMT_8,
CIRAMT_9,
CIRAMT_10,
CIRAMT_11,
CIRAMT_12,
CIRCNT_1,
CIRCNT_2,
CIRCNT_3,
CIRCNT_4,
CIRCNT_5,
CIRCNT_6,
CIRCNT_7,
CIRCNT_8,
CIRCNT_9,
CIRCNT_10,
CIRCNT_11,
CIRCNT_12,
NIRAMT_1,
NIRAMT_2,
NIRAMT_3,
NIRAMT_4,
NIRAMT_5,
NIRAMT_6,
NIRAMT_7,
NIRAMT_8,
NIRAMT_9,
NIRAMT_10,
NIRAMT_11,
NIRAMT_12,
NIRCNT_1,
NIRCNT_2,
NIRCNT_3,
NIRCNT_4,
NIRCNT_5,
NIRCNT_6,
NIRCNT_7,
NIRCNT_8,
NIRCNT_9,
NIRCNT_10,
NIRCNT_11,
NIRCNT_12,
CORAMT_1,
CORAMT_2,
CORAMT_3,
CORAMT_4,
CORAMT_5,
CORAMT_6,
CORAMT_7,
CORAMT_8,
CORAMT_9,
CORAMT_10,
CORAMT_11,
CORAMT_12,
CORCNT_1,
CORCNT_2,
CORCNT_3,
CORCNT_4,
CORCNT_5,
CORCNT_6,
CORCNT_7,
CORCNT_8,
CORCNT_9,
CORCNT_10,
CORCNT_11,
CORCNT_12,
NORAMT_1,
NORAMT_2,
NORAMT_3,
NORAMT_4,
NORAMT_5,
NORAMT_6,
NORAMT_7,
NORAMT_8,
NORAMT_9,
NORAMT_10,
NORAMT_11,
NORAMT_12,
NORCNT_1,
NORCNT_2,
NORCNT_3,
NORCNT_4,
NORCNT_5,
NORCNT_6,
NORCNT_7,
NORCNT_8,
NORCNT_9,
NORCNT_10,
NORCNT_11,
NORCNT_12,
BEXAMT_1,
BEXAMT_2,
BEXAMT_3,
BEXAMT_4,
BEXAMT_5,
BEXAMT_6,
BEXAMT_7,
BEXAMT_8,
BEXAMT_9,
BEXAMT_10,
BEXAMT_11,
BEXAMT_12,
BEXCNT_1,
BEXCNT_2,
BEXCNT_3,
BEXCNT_4,
BEXCNT_5,
BEXCNT_6,
BEXCNT_7,
BEXCNT_8,
BEXCNT_9,
BEXCNT_10,
BEXCNT_11,
BEXCNT_12,
BOTAMT_1,
BOTAMT_2,
BOTAMT_3,
BOTAMT_4,
BOTAMT_5,
BOTAMT_6,
BOTAMT_7,
BOTAMT_8,
BOTAMT_9,
BOTAMT_10,
BOTAMT_11,
BOTAMT_12,
BOTCNT_1,
BOTCNT_2,
BOTCNT_3,
BOTCNT_4,
BOTCNT_5,
BOTCNT_6,
BOTCNT_7,
BOTCNT_8,
BOTCNT_9,
BOTCNT_10,
BOTCNT_11,
BOTCNT_12,
SEXAMT_1,
SEXAMT_2,
SEXAMT_3,
SEXAMT_4,
SEXAMT_5,
SEXAMT_6,
SEXAMT_7,
SEXAMT_8,
SEXAMT_9,
SEXAMT_10,
SEXAMT_11,
SEXAMT_12,
SEXCNT_1,
SEXCNT_2,
SEXCNT_3,
SEXCNT_4,
SEXCNT_5,
SEXCNT_6,
SEXCNT_7,
SEXCNT_8,
SEXCNT_9,
SEXCNT_10,
SEXCNT_11,
SEXCNT_12,
SOTAMT_1,
SOTAMT_2,
SOTAMT_3,
SOTAMT_4,
SOTAMT_5,
SOTAMT_6,
SOTAMT_7,
SOTAMT_8,
SOTAMT_9,
SOTAMT_10,
SOTAMT_11,
SOTAMT_12,
SOTCNT_1,
SOTCNT_2,
SOTCNT_3,
SOTCNT_4,
SOTCNT_5,
SOTCNT_6,
SOTCNT_7,
SOTCNT_8,
SOTCNT_9,
SOTCNT_10,
SOTCNT_11,
SOTCNT_12,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
ME2.統一編號,
BRNO,
YEAR,
CEXAMT_1,
CEXAMT_2,
CEXAMT_3,
CEXAMT_4,
CEXAMT_5,
CEXAMT_6,
CEXAMT_7,
CEXAMT_8,
CEXAMT_9,
CEXAMT_10,
CEXAMT_11,
CEXAMT_12,
CEXCNT_1,
CEXCNT_2,
CEXCNT_3,
CEXCNT_4,
CEXCNT_5,
CEXCNT_6,
CEXCNT_7,
CEXCNT_8,
CEXCNT_9,
CEXCNT_10,
CEXCNT_11,
CEXCNT_12,
NEXAMT_1,
NEXAMT_2,
NEXAMT_3,
NEXAMT_4,
NEXAMT_5,
NEXAMT_6,
NEXAMT_7,
NEXAMT_8,
NEXAMT_9,
NEXAMT_10,
NEXAMT_11,
NEXAMT_12,
NEXCNT_1,
NEXCNT_2,
NEXCNT_3,
NEXCNT_4,
NEXCNT_5,
NEXCNT_6,
NEXCNT_7,
NEXCNT_8,
NEXCNT_9,
NEXCNT_10,
NEXCNT_11,
NEXCNT_12,
CIMAMT_1,
CIMAMT_2,
CIMAMT_3,
CIMAMT_4,
CIMAMT_5,
CIMAMT_6,
CIMAMT_7,
CIMAMT_8,
CIMAMT_9,
CIMAMT_10,
CIMAMT_11,
CIMAMT_12,
CIMCNT_1,
CIMCNT_2,
CIMCNT_3,
CIMCNT_4,
CIMCNT_5,
CIMCNT_6,
CIMCNT_7,
CIMCNT_8,
CIMCNT_9,
CIMCNT_10,
CIMCNT_11,
CIMCNT_12,
NIMAMT_1,
NIMAMT_2,
NIMAMT_3,
NIMAMT_4,
NIMAMT_5,
NIMAMT_6,
NIMAMT_7,
NIMAMT_8,
NIMAMT_9,
NIMAMT_10,
NIMAMT_11,
NIMAMT_12,
NIMCNT_1,
NIMCNT_2,
NIMCNT_3,
NIMCNT_4,
NIMCNT_5,
NIMCNT_6,
NIMCNT_7,
NIMCNT_8,
NIMCNT_9,
NIMCNT_10,
NIMCNT_11,
NIMCNT_12,
CIRAMT_1,
CIRAMT_2,
CIRAMT_3,
CIRAMT_4,
CIRAMT_5,
CIRAMT_6,
CIRAMT_7,
CIRAMT_8,
CIRAMT_9,
CIRAMT_10,
CIRAMT_11,
CIRAMT_12,
CIRCNT_1,
CIRCNT_2,
CIRCNT_3,
CIRCNT_4,
CIRCNT_5,
CIRCNT_6,
CIRCNT_7,
CIRCNT_8,
CIRCNT_9,
CIRCNT_10,
CIRCNT_11,
CIRCNT_12,
NIRAMT_1,
NIRAMT_2,
NIRAMT_3,
NIRAMT_4,
NIRAMT_5,
NIRAMT_6,
NIRAMT_7,
NIRAMT_8,
NIRAMT_9,
NIRAMT_10,
NIRAMT_11,
NIRAMT_12,
NIRCNT_1,
NIRCNT_2,
NIRCNT_3,
NIRCNT_4,
NIRCNT_5,
NIRCNT_6,
NIRCNT_7,
NIRCNT_8,
NIRCNT_9,
NIRCNT_10,
NIRCNT_11,
NIRCNT_12,
CORAMT_1,
CORAMT_2,
CORAMT_3,
CORAMT_4,
CORAMT_5,
CORAMT_6,
CORAMT_7,
CORAMT_8,
CORAMT_9,
CORAMT_10,
CORAMT_11,
CORAMT_12,
CORCNT_1,
CORCNT_2,
CORCNT_3,
CORCNT_4,
CORCNT_5,
CORCNT_6,
CORCNT_7,
CORCNT_8,
CORCNT_9,
CORCNT_10,
CORCNT_11,
CORCNT_12,
NORAMT_1,
NORAMT_2,
NORAMT_3,
NORAMT_4,
NORAMT_5,
NORAMT_6,
NORAMT_7,
NORAMT_8,
NORAMT_9,
NORAMT_10,
NORAMT_11,
NORAMT_12,
NORCNT_1,
NORCNT_2,
NORCNT_3,
NORCNT_4,
NORCNT_5,
NORCNT_6,
NORCNT_7,
NORCNT_8,
NORCNT_9,
NORCNT_10,
NORCNT_11,
NORCNT_12,
BEXAMT_1,
BEXAMT_2,
BEXAMT_3,
BEXAMT_4,
BEXAMT_5,
BEXAMT_6,
BEXAMT_7,
BEXAMT_8,
BEXAMT_9,
BEXAMT_10,
BEXAMT_11,
BEXAMT_12,
BEXCNT_1,
BEXCNT_2,
BEXCNT_3,
BEXCNT_4,
BEXCNT_5,
BEXCNT_6,
BEXCNT_7,
BEXCNT_8,
BEXCNT_9,
BEXCNT_10,
BEXCNT_11,
BEXCNT_12,
BOTAMT_1,
BOTAMT_2,
BOTAMT_3,
BOTAMT_4,
BOTAMT_5,
BOTAMT_6,
BOTAMT_7,
BOTAMT_8,
BOTAMT_9,
BOTAMT_10,
BOTAMT_11,
BOTAMT_12,
BOTCNT_1,
BOTCNT_2,
BOTCNT_3,
BOTCNT_4,
BOTCNT_5,
BOTCNT_6,
BOTCNT_7,
BOTCNT_8,
BOTCNT_9,
BOTCNT_10,
BOTCNT_11,
BOTCNT_12,
SEXAMT_1,
SEXAMT_2,
SEXAMT_3,
SEXAMT_4,
SEXAMT_5,
SEXAMT_6,
SEXAMT_7,
SEXAMT_8,
SEXAMT_9,
SEXAMT_10,
SEXAMT_11,
SEXAMT_12,
SEXCNT_1,
SEXCNT_2,
SEXCNT_3,
SEXCNT_4,
SEXCNT_5,
SEXCNT_6,
SEXCNT_7,
SEXCNT_8,
SEXCNT_9,
SEXCNT_10,
SEXCNT_11,
SEXCNT_12,
SOTAMT_1,
SOTAMT_2,
SOTAMT_3,
SOTAMT_4,
SOTAMT_5,
SOTAMT_6,
SOTAMT_7,
SOTAMT_8,
SOTAMT_9,
SOTAMT_10,
SOTAMT_11,
SOTAMT_12,
SOTCNT_1,
SOTCNT_2,
SOTCNT_3,
SOTCNT_4,
SOTCNT_5,
SOTCNT_6,
SOTCNT_7,
SOTCNT_8,
SOTCNT_9,
SOTCNT_10,
SOTCNT_11,
SOTCNT_12,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
