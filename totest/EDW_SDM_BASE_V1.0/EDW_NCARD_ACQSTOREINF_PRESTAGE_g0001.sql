-- SQL for table: EDW_NCARD_ACQSTOREINF_PRESTAGE
-- Trinity SQL Script
/* TRANSFORM_DATA */

/* 1.Truncate 目的表 */
TRUNCATE TABLE ${TARGET_SCHEMA}.${TARGET_TABLE};

/* 
2. 抽取 正式區Stage DATA_EXCH_DATE='#資料交換期別#' 之資料
3. 遮罩後寫入驗證區Prestage 
*/
INSERT INTO ${TARGET_SCHEMA}.${TARGET_TABLE}
(
ACQ_BU,
MER_NBR,
BR_NO,
UNIT_NO,
MER_NAME,
LOGO_NAME,
PIC_URL,
CHAIN_FLAG,
CHAIN_PROPERTY,
CHAIN_MER_NBR,
ENG_NAME,
BIZ_TYPE,
MCC_CODE,
STMT_ACTION,
MER_GROUP,
CREDIT_SCORE,
BIZ_ADDR_ZIP,
BIZ_ADDR_ZONE,
BIZ_ADDR,
BIZ_PHONE,
BIZ_FAX,
COUNTRY_CODE,
CITY_CODE,
STATE_NAME,
EMAIL_1,
EMAIL_2,
ESTBL_NAME,
ESTBL_ADDR_ZIP,
ESTBL_ADDR_ZONE,
ESTBL_ADDR,
ESTBL_PHONE,
ESTBL_CAP,
ESTBL_DTE,
PIC_NAME,
PIC_ID,
PIC_PHONE,
PIC_CELL_PHONE,
PIC_EMAIL,
REGISTER_ADDR_ZIP,
REGISTER_ADDR_ZONE,
REGISTER_ADDR,
STMT_NAME,
STMT_ADDR_ZIP,
STMT_ADDR_ZONE,
STMT_ADDR,
STMT_PHONE,
RECEIPT_NAME,
RECEIPT_ADDR_ZIP,
RECEIPT_ADDR_ZONE,
RECEIPT_ADDR,
CTC_NAME,
CTC_ID,
CTC_PHONE,
CTC_CELL_PHONE,
CTC_EMAIL,
SPONSOR_NAME_1,
SPONSOR_NBR_1,
SPONSOR_DEPOSIT_1,
SPONSOR_PHONE_1,
SPONSOR_NAME_2,
SPONSOR_NBR_2,
SPONSOR_DEPOSIT_2,
SPONSOR_PHONE_2,
CONTRACT_DTE,
CONTRACT_DTE_LAST,
ACQ_TYPE_V,
ACQ_TYPE_M,
ACQ_TYPE_J,
ACQ_TYPE_AE,
ACQ_TYPE_CUP,
CONTRACT_EFF_DTE_V,
CONTRACT_EFF_DTE_M,
CONTRACT_EFF_DTE_J,
CONTRACT_EFF_DTE_AE,
CONTRACT_EFF_DTE_CUP,
COMMEND_ACCT_V,
COMMEND_ACCT_M,
COMMEND_ACCT_J,
COMMEND_ACCT_AE,
COMMEND_ACCT_CUP,
CXL_CODE,
CXL_CODE_RSN,
CXL_DTE,
MER_STATUS,
MER_WARN_CODE,
MER_EST_VOL,
MER_EDC_FLAG,
MER_PINPAD_FLAG,
MER_CTL_FLAG,
MER_IMPRINTER_FLAG,
MER_MPOS_FLAG,
MER_EC_FLAG,
MER_AIR_FLAG,
MER_QRC_FLAG,
MER_NFC_FLAG,
MER_CAM_FLAG,
MER_TRAN_TYPE,
MER_PREPAID_FLAG,
MER_NOTPAY_FLAG,
MER_WEBSITE,
MER_3D_WEB_IP,
MER_3D_WEB_PORT,
MER_3D_FLAG_V,
MER_3D_FLAG_M,
MER_3D_FLAG_J,
MER_3D_FLAG_AE,
MER_3D_FLAG_CUP,
MER_3D_EFF_DTE_V,
MER_3D_EFF_DTE_M,
MER_3D_EFF_DTE_J,
MER_3D_EFF_DTE_AE,
MER_3D_EFF_DTE_CUP,
MER_3D_END_DTE_V,
MER_3D_END_DTE_M,
MER_3D_END_DTE_J,
MER_3D_END_DTE_AE,
MER_3D_END_DTE_CUP,
DC_BANK,
DC_BANK_NBR,
DC_METHOD,
DC_OWNER,
DC_OWNER_ID,
DC_FEE,
PMT_FREQ,
PMT_CYCLE,
PMT_DAYS,
PMT_CHAIN,
PMT_HOLD,
MER_USER_CHAR_1,
MER_USER_CHAR_2,
MER_USER_CHAR_3,
MER_USER_CHAR_4,
MER_USER_CHAR_5,
MER_USER_CHAR_6,
MER_USER_CHAR_7,
MER_USER_CHAR_8,
MER_USER_CHAR_9,
MER_USER_CHAR_10,
MER_USER_DTE_1,
MER_USER_DTE_2,
MER_USER_DTE_3,
MER_USER_DTE_4,
MER_USER_DTE_5,
MER_USER_AMT_1,
MER_USER_AMT_2,
MER_USER_AMT_3,
MER_USER_AMT_4,
MER_USER_AMT_5,
POST_RESULT,
CREATE_DT,
CREATE_USER,
MNT_DT,
MNT_USER,
CRD_FEE_RATE,
CUP_FEE_RATE,
CRD_COST_ONUS_RATE,
CRD_COST_OTH_RATE,
CUP_COST_ONUS_RATE,
CUP_COST_OTH_RATE,
DATA_UPDATE_TIME,
DATA_EXCH_DATE
)
SELECT
ACQ_BU,
MER_NBR,
BR_NO,
SDG.UFN_MASK_BAN(UNIT_NO),
SDG.UFN_MASK_NM(MER_NAME),
SDG.UFN_MASK_NM(LOGO_NAME),
PIC_URL,
CHAIN_FLAG,
CHAIN_PROPERTY,
CHAIN_MER_NBR,
SDG.UFN_MASK_NM(ENG_NAME),
BIZ_TYPE,
MCC_CODE,
STMT_ACTION,
MER_GROUP,
CREDIT_SCORE,
BIZ_ADDR_ZIP,
BIZ_ADDR_ZONE,
SDG.UFN_MASK_ADDR(BIZ_ADDR),
SDG.UFN_MASK_TEL(BIZ_PHONE),
BIZ_FAX,
COUNTRY_CODE,
CITY_CODE,
STATE_NAME,
SDG.UFN_MASK_EMAIL(EMAIL_1),
SDG.UFN_MASK_EMAIL(EMAIL_2),
ESTBL_NAME,
ESTBL_ADDR_ZIP,
ESTBL_ADDR_ZONE,
SDG.UFN_MASK_ADDR(ESTBL_ADDR),
SDG.UFN_MASK_TEL(ESTBL_PHONE),
ESTBL_CAP,
ESTBL_DTE,
SDG.UFN_MASK_NM(PIC_NAME),
SDG.UFN_MASK_IDN(PIC_ID),
SDG.UFN_MASK_TEL(PIC_PHONE),
SDG.UFN_MASK_TEL(PIC_CELL_PHONE),
SDG.UFN_MASK_EMAIL(PIC_EMAIL),
REGISTER_ADDR_ZIP,
REGISTER_ADDR_ZONE,
SDG.UFN_MASK_ADDR(REGISTER_ADDR),
STMT_NAME,
STMT_ADDR_ZIP,
STMT_ADDR_ZONE,
SDG.UFN_MASK_ADDR(STMT_ADDR),
SDG.UFN_MASK_TEL(STMT_PHONE),
SDG.UFN_MASK_NM(RECEIPT_NAME),
RECEIPT_ADDR_ZIP,
RECEIPT_ADDR_ZONE,
SDG.UFN_MASK_ADDR(RECEIPT_ADDR),
SDG.UFN_MASK_NM(CTC_NAME),
SDG.UFN_MASK_IDN(CTC_ID),
SDG.UFN_MASK_TEL(CTC_PHONE),
SDG.UFN_MASK_TEL(CTC_CELL_PHONE),
SDG.UFN_MASK_EMAIL(CTC_EMAIL),
SDG.UFN_MASK_NM(SPONSOR_NAME_1),
SDG.UFN_MASK_IDN(SPONSOR_NBR_1),
SPONSOR_DEPOSIT_1,
SDG.UFN_MASK_TEL(SPONSOR_PHONE_1),
SDG.UFN_MASK_NM(SPONSOR_NAME_2),
SDG.UFN_MASK_IDN(SPONSOR_NBR_2),
SPONSOR_DEPOSIT_2,
SDG.UFN_MASK_TEL(SPONSOR_PHONE_2),
CONTRACT_DTE,
CONTRACT_DTE_LAST,
ACQ_TYPE_V,
ACQ_TYPE_M,
ACQ_TYPE_J,
ACQ_TYPE_AE,
ACQ_TYPE_CUP,
CONTRACT_EFF_DTE_V,
CONTRACT_EFF_DTE_M,
CONTRACT_EFF_DTE_J,
CONTRACT_EFF_DTE_AE,
CONTRACT_EFF_DTE_CUP,
COMMEND_ACCT_V,
COMMEND_ACCT_M,
COMMEND_ACCT_J,
COMMEND_ACCT_AE,
COMMEND_ACCT_CUP,
CXL_CODE,
CXL_CODE_RSN,
CXL_DTE,
MER_STATUS,
MER_WARN_CODE,
MER_EST_VOL,
MER_EDC_FLAG,
MER_PINPAD_FLAG,
MER_CTL_FLAG,
MER_IMPRINTER_FLAG,
MER_MPOS_FLAG,
MER_EC_FLAG,
MER_AIR_FLAG,
MER_QRC_FLAG,
MER_NFC_FLAG,
MER_CAM_FLAG,
MER_TRAN_TYPE,
MER_PREPAID_FLAG,
MER_NOTPAY_FLAG,
MER_WEBSITE,
MER_3D_WEB_IP,
MER_3D_WEB_PORT,
MER_3D_FLAG_V,
MER_3D_FLAG_M,
MER_3D_FLAG_J,
MER_3D_FLAG_AE,
MER_3D_FLAG_CUP,
MER_3D_EFF_DTE_V,
MER_3D_EFF_DTE_M,
MER_3D_EFF_DTE_J,
MER_3D_EFF_DTE_AE,
MER_3D_EFF_DTE_CUP,
MER_3D_END_DTE_V,
MER_3D_END_DTE_M,
MER_3D_END_DTE_J,
MER_3D_END_DTE_AE,
MER_3D_END_DTE_CUP,
DC_BANK,
SDG.UFN_MASK_ACCT(DC_BANK_NBR),
DC_METHOD,
SDG.UFN_MASK_NM(DC_OWNER),
SDG.UFN_MASK_IDN(DC_OWNER_ID),
DC_FEE,
PMT_FREQ,
PMT_CYCLE,
PMT_DAYS,
PMT_CHAIN,
PMT_HOLD,
MER_USER_CHAR_1,
MER_USER_CHAR_2,
MER_USER_CHAR_3,
MER_USER_CHAR_4,
MER_USER_CHAR_5,
MER_USER_CHAR_6,
MER_USER_CHAR_7,
MER_USER_CHAR_8,
MER_USER_CHAR_9,
MER_USER_CHAR_10,
MER_USER_DTE_1,
MER_USER_DTE_2,
MER_USER_DTE_3,
MER_USER_DTE_4,
MER_USER_DTE_5,
MER_USER_AMT_1,
MER_USER_AMT_2,
MER_USER_AMT_3,
MER_USER_AMT_4,
MER_USER_AMT_5,
POST_RESULT,
CREATE_DT,
CREATE_USER,
MNT_DT,
MNT_USER,
CRD_FEE_RATE,
CUP_FEE_RATE,
CRD_COST_ONUS_RATE,
CRD_COST_OTH_RATE,
CUP_COST_ONUS_RATE,
CUP_COST_OTH_RATE,
CURRENT_TIMESTAMP,
to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
FROM ${SOURCE_TABLE_OWNER}.${SOURCE_TABLE}
WHERE ${DATA_LIFE_BASE} = to_date('${BD_EXCH_DATE}', 'yyyy-MM-dd')
;

.export @LOAD_ROWCNT updatecnt;
